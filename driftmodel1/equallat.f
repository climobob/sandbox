C$$$  SUBPROGRAM DOCUMENTATION BLOCK
C
C SUBPROGRAM:  EQUALLAT   COMPUTE EQUALLY-SPACED LATITUDES
C   PRGMMR: IREDELL       ORG: W/NMC23       DATE: 92-04-16
C
C ABSTRACT: COMPUTES COSINES OF COLATITUDE AND GAUSSIAN WEIGHTS
C           ON EQUALLY-SPACED LATITUDES (INCLUDING POLES).
C           THE WEIGHTS ARE COMPUTED BASED ON ELLSAESSER (JAM,1966).
C
C PROGRAM HISTORY LOG:
C   92-04-16  IREDELL
C   93-12-28  IREDELL  MODIFIED WEIGHTS BASED ON ELLSAESSER
C
C USAGE:    CALL EQUALLAT(K,A,W)
C
C   INPUT ARGUMENT LIST:
C     K        - NUMBER OF LATITUDES.
C
C   OUTPUT ARGUMENT LIST:
C     A        - REAL (K) COSINES OF COLATITUDE.
C     W        - REAL (K) GAUSSIAN WEIGHTS.
C
C SUBPROGRAMS CALLED:
C   MINV         SOLVES FULL MATRIX PROBLEM
C
C REMARKS: FORTRAN 9X EXTENSIONS ARE USED.
C
C ATTRIBUTES:
C   CRAY YMP.
C
C$$$
      SUBROUTINE EQUALLAT(K,A,W)
      DIMENSION A(K),W(K)
      DIMENSION AWORK((K+1)/2-1,(K+1)/2),BWORK(((K+1)/2-1)*2)
      PARAMETER(PI=3.14159265358979)
      KH=K/2
      KHE=(K+1)/2
      DLT=PI/(K-1)
      A(1)=1.
      DO J=2,KH
        A(J)=COS((J-1)*DLT)
      ENDDO
      IF(KHE.GT.KH) A(KHE)=0.
      DO JS=1,KHE-1
        DO J=2,KHE
          AWORK(JS,J-1)=COS(2*(JS-1)*(J-1)*DLT)
        ENDDO
      ENDDO
      DO JS=1,KHE-1
        AWORK(JS,KHE)=-1./(4*(JS-1)**2-1)
      ENDDO
      CALL MINV(AWORK,KHE-1,KHE-1,BWORK,DA,1.E-12,1,0)
      W(1)=0.
      DO J=2,KHE
        W(J)=AWORK(J-1,KHE)
      ENDDO
CDIR$ IVDEP
      DO J=1,KH
        A(K+1-J)=-A(J)
        W(K+1-J)=W(J)
      ENDDO
      RETURN
      END
