Received: from PSUVM by PSUVM.PSU.EDU (Mailer R2.08) with BSMTP id 8350; Tue,
 11 Feb 92 08:57:42 EST
Received: from SCFVM.GSFC.NASA.GOV by PSUVM.PSU.EDU (IBM VM SMTP V2R1) with TCP;
   Tue, 11 Feb 92 08:57:34 EST
Received: from rico.gsfc.nasa.gov by SCFVM.GSFC.NASA.GOV (IBM VM SMTP R1.2.2MX)
 with TCP; Tue, 11 Feb 92 08:58:09 EST
Received: by rico .gsfc.nasa.gov (5.52/5.6)
        id AA00859; Tue, 11 Feb 92 08:35:40 EST
Date: Tue, 11 Feb 92 08:35:40 EST
From: Guest Account <guest@rico.gsfc.nasa.gov>
Message-Id: <9202111335.AA00859@rico .gsfc.nasa.gov>
Apparently-To: rmg3@psuvm.psu.edu
 
//TEST23  JOB  (OCE,O120),'M.GOOD',CLASS=K
/*JOBPARM BIN=O241,LINES=50
/*SETUP PLEASE MOUNT TAPE 100422 (R.O.) ON T6250 DRIVE.THANKS.
//* //RUN  EXEC  FORTCLG,PARM.FORT='AUTODBL(DBL)',FXPOPT=2
//RUN  EXEC  FORTCLG,TIME.GO=10,REGION.GO=600K
//FORT.SYSIN DD *
C*******************************************************************
C
C     THE PARKINSON SEA-ICE MODEL
C
C     MODEL DESCRIPTION *********
C
C  THIS LARGE-SCALE SEA ICE MODEL SIMULATES THE YEARLY CYCLE OF ICE IN
C  BOTH THE NORTHERN AND SOUTHERN HEMISPHERES ( SEPERATE PRGRM. RUNS -
C  SEE BELOW ).  HORIZONTAL RESOLUTION IS APPROXIMATELY 200 KM., WHILE
C  THE MODEL HAS FOR VERTICAL LAYERS: ICE,SNOW,OCEAN AND ATMOSPHERE.
C  BOTH THERMODYNAMIC ( SUBROUTINE THERMO ) AND DYNAMIC ( SUBROUTINE
C  DNAMIC ) PROCESSES ARE INCORPORATED, THE THERMODYNAMICS BEING BASED O
C  ENERGY BALANCES AT THE VARIOUS INTERFACES AND THE DYNAMICS BEING BASE
C  ON THE FOLLOWING FIVE STRESSES: WIND STRESS, WATER STRESS, CORIOLIS
C  FORCE, INTERNAL ICE RESISTANCE, AND THE STRESS FROM THE TILT OF THE
C  SEA SURFACE ( DYNAMIC TOPOGRAPHY ).  EACH MODEL GRID SQUARE HAS A
C  VARIABLE PERCENTAGE OF ITS AREA ASSUMED ICE FREE, THE GRID SIZES
C  BEING 42X31 FOR THE NORTHERN HEMISPHERE AND 41X41 FOR THE SOUTHERN
C  HEMISPHERE.  FOR FURTHER INFORMATION SEE:
C
C     ' A LARGE-SCALE NUMERICAL MODEL OF SEA ICE '
C     CLAIRE L. PARKINSON AND WARREN M. WASHINGTON
C     JOURNAL OF GEOPHYSICAL RESEARCH,   JANUARY 20, 1979
C
C  ******************************************************************
C
C     TO INITIALIZE THE PROGRAM :
C
C               FOR ARCTIC CASE, SET IHEMI=1
C               FOR ANTARCTIC, SET IHEMI=2
C
C               VERIFY THAT THE PROPER INPUT TAPE IS SPECIFIED IN
C               THE JCL (SEE COMMENT CARDS SURROUNDING JCL).
C               (INPUT FILE = FT08F001).
C
C               SPECIFY THE START AND END YEARS FOR THE
C               SIMULATION USING (NYMIN) AND (NYMAX), RESPECTIVELY.
C
C               JCL CHANGES AND AN APPROPRIATE INPUT TAPE ARE NEEDED
C               FOR RUNS WITH NYMIN > 1 .
C
C               IF OUTPUT ARRAYS ARE TO BE WRITTEN TO TAPE,
C               SET NYTAPE= THE DESIRED YEAR (ARRAYS ARE WRITTEN
C               AT YEAR'S END). JCL CHANGES WILL BE NEEDED.
C
C               FOR NO TAPE OUTPUT, SET NYTAPE > NYMAX, AND DUMMY OUT
C               THE OUTPUT FILE (= FT04F001).
C
C**********************************************************************
C
      IHEMI=1
      NYMIN=1
      NYMAX=4
      NYTAPE=99
      IF(IHEMI.EQ.2) GO TO 10
      ITOTAL=42
      JTOTAL=31
      GO TO 20
   10 CONTINUE
      ITOTAL=41
      JTOTAL=41
   20 CONTINUE
      IT=ITOTAL
      JT=JTOTAL
      CALL MAINPG(IHEMI,IT,JT,NYMIN,NYTAPE,NYMAX)
      STOP
      END
C
      SUBROUTINE MAINPG(IHEMI,IT,JT,NYMIN,NYTAPE,NYMAX)
C
      COMMON SEALND(42,41),TSNOW(42,31),HICE(42,31),HSNO(42,31),
     1FREE(42,31),FXSOL(42,31),TOCN(42,31),FXBTM(42,31),TICE(42,31),
     2TEMPM(42,31,12),DEWM(42,31,12),UMAT(42,31,12),VMAT(42,31,12)
      COMMON /C1/ TEMP,FLON,DEW,VP,CLDD,DRAGW
      COMMON /C2/ AREA,AMIN,DT,DMIX,EYN,QS,QI,SIGMA,SK,TB,YK
      COMMON /C3/ FSEN,FSENW,FMI,DAY,SNO(12)
      COMMON /C4/ TS,TI,HI,HS,TW,WIND,TWI,FLAT,DRAG,FLATW,FLONW
      COMMON /C5/ DTOP(42,41)
      COMMON /C6/ RLAT,RLONG,DLAT,DLONG,NSTEP,
     1COSZ,STIME,TIME,TSFLUX,XLAT(42,31),XLON(42,31)
      COMMON /C7/ NCC,NCB
      COMMON /C8/ UICE(42,31),VICE(42,31),STEP
      COMMON /C9/ AIRD
      COMMON /C10/ Q10M,QSURF
      DIMENSION TWUI(42,31),CLD(12)
      DIMENSION SNO2(12)
      DATA CL1/1.291677E-6/,CL2/3.125025E-4/,CL3/2.712106E-2/,
     1 CL4/0.9952592/,CL5/13.69014/,CL6/1.205E-6/,CL7/2.934E-4/,
     2 CL8/2.55645E-2/,CL9/0.94371/,CL10/13.138/
      DATA  CLD/.50,.50,.50,.55,.70,.75,.75,.80,.80,.70,.60,.50/
      DATA EMI/0.97/,EMS/0.99/,ASTART/0.10/,DEG/57.2958/
      DATA AI/0.5/,AS/0.75/,AW/0.1/
C
C SET MONTHLY SNOWFALL RATES FOR APPROPRIATE HEMISPHERE
      DATA SNO2/0.0,0.0,1.1574E-9,1.1574E-9,1.1574E-9,1.1574E-9,
     11.1574E-9,1.1574E-9,1.1574E-9,1.1574E-9,1.1574E-9,0.0/
      SNO(1)=3.215E-9
      SNO(2)=3.215E-9
      SNO(3)=3.215E-9
      SNO(4)=3.215E-9
      SNO(5)=19.290E-9
      SNO(6)=0.0
      SNO(7)=0.0
      SNO(8)=0.0
      SNO(9)=49.603E-9
      SNO(10)=49.603E-9
      SNO(11)=3.215E-9
      SNO(12)=3.215E-9
      IF(IHEMI.EQ.1) GO TO 7
      DO 6 III=1,12
    6 SNO(III)=SNO2(III)
    7 CONTINUE
C SET OCEANIC HEAT FLUXES
      FMI=2.0+23.0*(IHEMI-1)
      SIGMA=5.67E-8
      NSTEP=90
      DT=28800.0
      EYN=0.17
      SK=0.31
      YK=2.04
      QS=110.0E6
      QI=302.0E6
      TS=271.20
      TI=271.20
      TB=271.20
      DMIX=30.0
      TW=271.45
      TWI=271.45
      EMW=0.97
      DRAG=0.00175
      DRAGW=0.00175
      AREA=ASTART
      IF(IHEMI.EQ.2)GOTO20
      HI=3.5
      HS=0.3
      AMIN=0.005
      PRINT 885
  885 FORMAT (1X,6HARCTIC)
      GO TO 21
   20 HI=1.5
      HS=0.0
      AMIN=0.02
      PRINT 884
  884 FORMAT(1X,9HANTARCTIC)
   21 CONTINUE
C READ SEA,LAND DATA CARDS
      READ (5,888) ((SEALND(I,J),I=1,42),J=1,31)
  888 FORMAT (2X,42F1.0)
      DO 1 J=1,31
      READ(5,50)  (DTOP(I,J),I=1,42)
   50 FORMAT(14F5.2)
    1 CONTINUE
      IF(IHEMI.EQ.1) GO TO 23
      READ(5,889) ((SEALND(I,J),I=1,41),J=1,41)
  889 FORMAT(41F1.0)
      DO 3 J=1,41
      READ(5,51) (DTOP(I,J),I=1,41)
   51 FORMAT(14F5.2)
    3 CONTINUE
   23 CONTINUE
C READ DATA FOR MONTH FROM TAPE
      CALL POSN(1,8,1)
C NOTE:  HICE,HSNO,FREE AND TOCN  = TEMPM,DEWM,UMAT+VMAT HERE
      DO 15 M=1,12
       CALL FREAD(HICE,8,LEN,&105,&106)
       CALL FREAD(HSNO,8,LEN,&105,&106)
       CALL FREAD(FREE,8,LEN,&105,&106)
       CALL FREAD(TOCN,8,LEN,&105,&106)
C
      IF(NYTAPE.GT.NYMAX) GO TO 13
      CALL FWRITE(HICE,4,LEN)
      CALL FWRITE(HSNO,4,LEN)
      CALL FWRITE(FREE,4,LEN)
      CALL FWRITE(TOCN,4,LEN)
   13 CONTINUE
       DO 14 I=1,IT
       DO 14 J=1,JT
       TEMPM(I,J,M)=HICE(I,J)
       DEWM(I,J,M)=HSNO(I,J)
       UMAT(I,J,M)=FREE(I,J)
C      UMAT(I,J,M)=4.*FREE(I,J)
       VMAT(I,J,M)=TOCN(I,J)
C      VMAT(I,J,M)=4.*TOCN(I,J)
   14  CONTINUE
   15 CONTINUE
C
C      CALL FREAD(DTOP,8,LEN,&105,&106)
C INITIALIZE GRID POINT VALUES
C
      IF(NYMIN.EQ.1) GO TO 16
C
       CALL FREAD(HICE,8,LEN,&105,&106)
       CALL FREAD(HSNO,8,LEN,&105,&106)
       CALL FREAD(FREE,8,LEN,&105,&106)
       CALL FREAD(TOCN,8,LEN,&105,&106)
       CALL FREAD(TWUI,8,LEN,&105,&106)
       CALL FREAD(FXSOL,8,LEN,&105,&106)
       CALL FREAD(FXBTM,8,LEN,&105,&106)
       CALL FREAD(TSNOW,8,LEN,&105,&106)
       CALL FREAD(TICE,8,LEN,&105,&106)
      GO TO 305
   16 CONTINUE
C
      DO 303 I=1,IT
      DO 303 J=1,JT
      HICE(I,J)=HI
      HSNO(I,J)=HS
      FREE(I,J)=AREA
      TOCN(I,J)=TW
      TSNOW(I,J)=TS
      TICE(I,J)=TI
      TWUI(I,J)=TWI
  303 CONTINUE
  305 CONTINUE
C
C INITIALIZE LAND GRID PT VALUES
      DO 304 I=1,IT
      DO 304 J=1,JT
      IF (SEALND(I,J) .NE. 0.0) GO TO 304
      HICE(I,J)=-100.0
      HSNO(I,J)=-100.0
      FREE(I,J)=-100.0
      TOCN(I,J)=-100.0
      TWUI(I,J)=-100.0
      FXSOL(I,J)=-100.0
      FXBTM(I,J)=-100.0
304   CONTINUE
C DETERMINE GEOGRAPHIC COORDINATES
      CALL COORD (IT,JT,IHEMI)
      NN=IFIX(NSTEP/2.+1)
C
C  PERFORM CALCULATIONS, LOOPING THROUGH EACH TIME STEP OF EACH
C    MONTH OF EACH YEAR
C
      DO 900 NY=NYMIN,NYMAX
      DO 850 M=1,12
C
      PRINT 5,NY,M
    5 FORMAT (///1X,'BEGINNING YEAR',I3,', MONTH',I3)
      M7=7-M
      M13=M-1
      IF(M.LE.7) GO TO 52
      M7=M-7
      M13=13-M
   52 CONTINUE
      CLDD=CLD(M)
      DO 800 N=1,NSTEP
      DAY=30.*FLOAT(N)/FLOAT(NSTEP)
      NCB=0
      NZ=N+90*(M-1)
      NZ=MOD(NZ,11)
      IF (N.EQ.45) NCB=1
      IF (N.LE.45) STEP=(N+NN-1.)/FLOAT(NSTEP)
      IF (N.GE.46) STEP=(N-NN+1.)/FLOAT(NSTEP)
      M2=M
      IF (N.GE.46) M2=M+1
      M1=M2-1
      IF (M2.EQ.13) M2=1
      IF (M1.EQ.0) M1=12
C SWEEP GRIDPTS FOR THIS TIMESTEP
      DO 3005 J=1,JT
      DO 3005 I=1,IT
      NCC=0
      IF(IHEMI.EQ.2) GO TO 308
      IF (I.EQ.19.AND.J.EQ.16) NCC=NCB+1
      IF (I.EQ.20.AND.J.EQ.18) NCC=NCB+1
      GO TO 309
  308 CONTINUE
      IF (I.EQ.32.AND.J.EQ.26) NCC=NCB+1
      IF (I.EQ.32.AND.J.EQ.27) NCC=NCB+1
  309 CONTINUE
C JUMP TO END OF LOOP FOR LAND PTS
      IF (SEALND(I,J) .LE. 0.5) GO TO 3005
      RLAT=XLAT(I,J)
      DLAT=RLAT*DEG
C SET UNDIMENSIONED VARIABLES TO GRID PT VALUE  IN PREPARATION FOR THERM
      TS=TSNOW(I,J)
      TI=TICE(I,J)
      HI=HICE(I,J)
      HS=HSNO(I,J)
      AREA=FREE(I,J)
      TW=TOCN(I,J)
      TWI=TWUI(I,J)
      TEMP=(TEMPM(I,J,M2)-TEMPM(I,J,M1))*STEP+TEMPM(I,J,M1)
      DEW=(DEWM(I,J,M2)-DEWM(I,J,M1))*STEP+DEWM(I,J,M1)
      UWIND=(UMAT(I,J,M2)-UMAT(I,J,M1))*STEP+UMAT(I,J,M1)
      VWIND=(VMAT(I,J,M2)-VMAT(I,J,M1))*STEP+VMAT(I,J,M1)
      WIND=SQRT(UWIND*UWIND+VWIND*VWIND)
      AIRD=(353.31-9.06*(IHEMI-1))/TEMP
      IF(IHEMI.EQ.1) GO TO 24
C CALCULATE SET CLOUD AMOUNT
      DL1=-DLAT
      DL2=DL1*DL1
      DL3=DL2*DL1
      DL4=DL3*DL1
      XANC=CL1*DL4-CL2*DL3+CL3*DL2-CL4*DL1+CL5
      XULYC=CL6*DL4-CL7*DL3+CL8*DL2-CL9*DL1+CL10
      CLDD=(M7*XANC+M13*XULYC)/6.0
   24 CONTINUE
C COMPUTE LONG WAVE AND LATENT HEAT FLUXES
C  OUTPUTS OF FILONG ARE VALUES FOR FLON, FLAT, FLONW, FLATW
      CALL FILONG(M,IHEMI)
C  COMPUTE SOLAR FLUX ONCE EVERY 3+DAYS, I.E. ONCE EVERY 11 TIMESTEPS
C   OUTPUT OF CALLING SOLARF IS VALUE FOR TSFLUX
      TSFLUX=FXSOL(I,J)
      DLONG=XLON(I,J)* DEG
      IF(NZ.NE.1)GOTO74
      CALL SOLARF(M,N,IT,JT)
   74 CONTINUE
C  COMPUTE SENSIBLE HEAT FLUX
      FSEN=AIRD*1004.0*DRAG   *WIND*(TEMP-TS)
      FSENW=AIRD*1004.*DRAGW*WIND*(TEMP-TW)
      IF (NCC.NE.2) GO TO 60
      IF(IHEMI.EQ.2) GO TO 60
      AU=AI
      EMUU=EMI
      IF (HS.EQ.0.0) GO TO 62
      AU=AS
      EMUU=EMS
   62 A1=FLON*EMUU
      A2=TSFLUX*(1.0-AU)
      A3=FLONW*EMW
      A4=TSFLUX*(1.0-AW)
      A5=FSEN*(1.0-AREA)+FSENW*AREA
      A6=FLAT*(1.0-AREA)+FLATW*AREA
      A7=FLON*(1.0-AREA)+FLONW*AREA
      A8=A1*(1.0-AREA)+A3*AREA
      A9=A2*(1.0-AREA)+A4*AREA
      PRINT 61, NY,M,N,I,J,FSEN,FLAT,FLON,A1,TSFLUX,A2,
     1 FSENW, FLATW,FLONW,A3,TSFLUX,A4,                  A5,A6,A7,A8,
     2 TSFLUX,A9,                   WIND, TEMP,TS,TW,CLDD,AREA
     3,DLAT,DLONG
   61 FORMAT (1X,'YEAR',I3,', MONTH',I3, ', TIMESTEP',I3, '     DATA FOR
     2 POINT I=',I3,'J=',I3/14X,'         H            LE            LWD
     3          EM LWD          SWD          SWNET'
     4          /4X,'OVER ICE  ',6F14.4/4X,'OVER WATER',6F14.4/
     5 4X,'WEIGHTED  ',6F14.4       /4X,'WIND =',F9.5,', TEMP =',F9.4,
     6 ', TS =',F9.4 ,     ', TW =',F9.4,',CLOUD =', F7.4,', LEAD AREA =
     7',F7.4,', LAT,LONG=',2F9.4)
      PRINT 584,I,J,AIRD,WIND,TEMP,TS,TW,Q10M,QSURF,HI
  584 FORMAT (1X,2I3,'AIR DENSITY =',F7.3,' WIND =',F8.4,3F9.4,3F10.5)
   60 CONTINUE
C COMPUTE VALUES FOR DEPTH AND TEMPERATURE OF SNOW AND ICE
C
      CALL THERMO (NY,M,N,I,J,IT,JT,IHEMI)
C
C PRESERVE VARIABLE VALUES FOR GRID POINT
      TSNOW(I,J)=TS
      TICE(I,J)=TI
      HICE(I,J)=HI
      HSNO(I,J)=HS
      FREE(I,J)=AREA
      TOCN(I,J)=TW
      TWUI(I,J)=TWI
      FXSOL(I,J)=TSFLUX
      FXBTM(I,J)=FB
3005  CONTINUE
      MZ=MOD(N,5)
      IF (MZ.EQ.0) CALL DNAMIC (N,M,NY,IT,JT,IHEMI)
      IF (N.NE.45) GO TO 800
      IF(IHEMI.EQ.2) GO TO 43
      IF(IHEMI.EQ.1) GO TO 400
C
C
      PRINT 995
      PRINT 998
      DO 980 J=1,31
      JJ=32-J
      PRINT 989,JJ,(UICE(I,JJ),I=1,9)
  980 CONTINUE
      PRINT 995
      DO 981 J=1,31
      JJ=32-J
      PRINT 989,JJ,(UICE(I,JJ),I=10,18)
  981 CONTINUE
      PRINT 995
      DO 982 J=1,31
      JJ=32-J
      PRINT 989,JJ,(UICE(I,JJ),I=19,27)
  982 CONTINUE
      PRINT 995
      DO 983 J=1,31
      JJ=32-J
      PRINT 989,JJ,(UICE(I,JJ),I=28,36)
  983 CONTINUE
      PRINT 995
      DO 984 J=1,31
      JJ=32-J
      PRINT 989,JJ,(UICE(I,JJ),I=37,42)
  984 CONTINUE
C
      PRINT 995
      PRINT 994
      DO 985 J=1,31
      JJ=32-J
      PRINT 989,JJ,(VICE(I,JJ),I=1,9)
  985 CONTINUE
      PRINT 995
      DO 986 J=1,31
      JJ=32-J
      PRINT 989,JJ,(VICE(I,JJ),I=10,18)
  986 CONTINUE
      PRINT 995
      DO 987 J=1,31
      JJ=32-J
      PRINT 989,JJ,(VICE(I,JJ),I=19,27)
  987 CONTINUE
      PRINT 995
      DO 988 J=1,31
      JJ=32-J
      PRINT 989,JJ,(VICE(I,JJ),I=28,36)
  988 CONTINUE
      PRINT 995
      DO 979 J=1,31
      JJ=32-J
      PRINT 989,JJ,(VICE(I,JJ),I=37,42)
  979 CONTINUE
C
      PRINT 995
  989 FORMAT(1X,I2,2X,9(E12.4,1X))
  998 FORMAT(1X,'VALUES FOR UICE(I,J)',//)
  994 FORMAT(1X,'VALUES FOR VICE(I,J)',//)
  995 FORMAT(1X///)
  400 CONTINUE
C
C
      PRINT 42, HICE(7,4),HSNO(7,4),FREE(7,4),UICE(7,4),VICE(7,4)
     3,HICE(7,29),HSNO(7,29),FREE(7,29),UICE(7,29),VICE(7,29),
     3 HICE(26,16),HSNO(26,16),FREE(26,16),UICE(26,16),VICE(26,16),
     4 HICE(22,14),HSNO(22,14),FREE(22,14),UICE(22,14),VICE(22,14)
   42 FORMAT (/1X,'POINT (7,4) HAS HICE,HSNO,FREE,UICE,VICE =',5F10.6/
     2 1X,                             'POINT (7,29) HAS',5F10.6/
     2 1X,'POINT 26,16  HAS',5F10.6/1X,'POINT 22,14  HAS',5F10.6)
      PRINT 782, (FREE(26,J1),J1=15,29)
  782 FORMAT (1X,'FREE (26,J) = ',15F6.4)
      GO TO 44
   43 CONTINUE
      PRINT 41, HICE(32,26),HSNO(32,26),FREE(32,26),UICE(32,26),
     2VICE(32,26),HICE(32,27),HSNO(32,27),FREE(32,27),UICE(32,27),
     4VICE(32,27),HICE(34,21),HSNO(34,21),FREE(34,21),UICE(34,21),
     5 VICE(34,21)
   41 FORMAT(/1X,'POINT (32,26) HAS HICE,HSNO,FREE,UICE,VICE ',5F10.6/
     2 1X,'POINT (32,27) HAS',5F10.6/1X,'POINT (34,21) HAS',5F10.6)
   44 CONTINUE
      DO 56 JJ=1,JT
      J=JT+1-JJ
      PRINT 57,J,(HICE(I,J),I=1,23)
   57 FORMAT (1X,I2,1X,23F5.2)
   56 CONTINUE
      DO 58 JJ=1,JT
      J=JT+1-JJ
      PRINT 59,J,(HICE(I,J),I=24,IT)
   59 FORMAT (5X,I2,1X,19F5.2,'HICE')
   58 CONTINUE
  800 CONTINUE
C
 850  CONTINUE
 900  CONTINUE
C
      IF(NYTAPE.GT.NYMAX) GO TO 104
      LEN=5208+1516*(IHEMI-1)
      CALL FWRITE(HICE,4,LEN)
      CALL FWRITE(HSNO,4,LEN)
      CALL FWRITE(FREE,4,LEN)
      CALL FWRITE(TOCN,4,LEN)
      CALL FWRITE(TWUI,4,LEN)
      CALL FWRITE(FXSOL,4,LEN)
      CALL FWRITE(FXBTM,4,LEN)
      CALL FWRITE(TSNOW,4,LEN)
      CALL FWRITE(TICE,4,LEN)
  104 CONTINUE
       STOP
 105   WRITE(6,9899)
9899   FORMAT(' END OF FILE ENCOUNTERED')
       STOP
 106   WRITE(6,9999)
9999   FORMAT(' I/O ERROR ON TAPE')
      RETURN
      END
C
      SUBROUTINE THERMO (NY,M,N,I,J,IT,JT,IHEMI)
C
      COMMON /C1/ TEMP,FLON,DEW  ,VP,CLDD,DRAGW
      COMMON /C2/ AREA,AMIN,DT,DMIX,EYN,QS,QI,SIGMA,SK,TB,YK
      COMMON /C3/ FSEN,FSENW,FMI,DAY,SNO(12)
      COMMON /C4/ TS,TI,HI,HS,TW,WIND,TWI,FLAT,DRAG,FLATW,FLONW
      COMMON /C6/ RLAT,RLONG,DLAT,DLONG,NSTEP,
     1COSZ,STIME,TIME,TSFLUX,XLAT(42,31),XLON(42,31)
      COMMON /C7/ NCC,NCB
      DATA EMI/0.97/,EMS/0.99/,EMW/0.97/,CW/4.19E6/
      DATA AI/0.5/,AS/0.75/,AW/0.1/,HMIN/0.01/
      FDMO=0.0
C     FDMO=FMI
C ***************************
      ALAST=AREA
      HL=HI
      HSL=HS
C1 CASE OF NO ICE
      IF (HI.NE.0.0) GO TO 10
      TW=TW+DT*((1.0-AW)*TSFLUX+FSENW+FLATW+FLONW*EMW-SIGMA*(TW**4)*
     * EMW+FDMO)/(DMIX*CW)
      IF (TW.GT.TB) GO TO 11
      HI=HMIN
      A1=1.0-(TB-TW)*DMIX*CW/(QI*HMIN)
      AREA=AMIN1(.999,A1)
      AREA=AMAX1(AMIN,AREA)
      TW=TB
      TWI=TB
      TS=TB
      GO TO 11
   10 CONTINUE
      TPAST=TS
      STPC=SIGMA*(TPAST**3)
C2 CASE OF ICE WITH NO SNOW
      IF (HS.NE.0.0) GO TO 12
C   SOLVE FOR SURFACE ICE TEMPERATURE
      CON=YK/HI
C     EYE=0.17*0.4
      EYE=0.068
      TI=TPAST+(FLAT+FSEN+FLON*EMI+(1.0-EYE)*(1.0-AI)*TSFLUX-STPC
     1 *TPAST*EMI +CON*(TB  -TPAST))/(4.*STPC*EMI+CON)
      TI=0.25*TI   +0.75*TPAST
      TI=AMIN1(TI,273.05)
      TS=TI
C   COMBINE FLUXES
      FA=-FLAT-FSEN-(1.0-EYE)*(1.0-AI)*TSFLUX+SIGMA*(TS**4)*EMI-FLON*EMI
      FO=YK*(TB-TI)/HI
      IF (NCC.NE.2) GO TO 21
      TT1=STPC*TPAST*EMI
      TT2=SIGMA*(TS**4)*EMI
      PRINT 27, FMI,FO,TT1,TT2     ,TI,TS,STPC,CON,FA
   27 FORMAT (4X,'ICE WITH NO SNOW,   OCEAN FLUX =',F11.6,', CONDUCTIVE
     2FLUX =',F11.6,', AND OUTGOING LONGWAVE FLUX =',F11.5,',', F11.5
     3 /2F9.4,3F15.5)
   21 CONTINUE
      IF(TI.EQ.273.05) GO TO 13
C   ALLOW SNOWFALL ON FROZEN ICE SURFACE
      IF (SNO(M) .GT. 0.0) HS=0.01
      IF(IHEMI.EQ.1.AND.M.EQ.8.AND.DAY.GT.20.) HS=0.01
      GO TO 14
   13 CONTINUE
C  MELT ICE IF SURFACE TEMPERATURE EXCEEDS  273.05K
      HI=HI+DT*(FA-FO)/QI
      HI=AMIN1(HI,HL)
      GO TO 14
   12 CONTINUE
C3 CASE OF SNOW-COVERED ICE
      CON=SK*YK/(HI*SK+HS*YK)
C   SOLVE FOR SNOW SURFACE TEMPERATURE
      TS=TPAST+(FLAT+FSEN+FLON*EMS+(1.0-AS)*TSFLUX-STPC*TPAST*EMS+(TB-
     1 TPAST)*CON)/(4.0*STPC*EMS+CON)
      TS=0.25*TS+0.75*TPAST
      IF(TS.GT.273.15) TS=273.15
C   SOLVE FOR SNOW-ICE INTERFACE TEMPERATURE
      TI=(HI*SK*TS +  HS*YK*TB  )/(HI*SK+   HS*YK)
C   COMPUTE FLUXES
      FA=-FLAT-FSEN-(1.0-AS)*TSFLUX+SIGMA*(TS**4)*EMS-FLON*EMS
      FS=SK*(TI-TS)/HS
      FO=FS
      IF (NCC.NE.2) GO TO 22
      TT1=STPC*TPAST*EMS
      TT2=SIGMA*(TS**4)*EMS
      PRINT 28, FMI,FO,TT1,TT2      ,TS,TI,CON,STPC,FA,FS
   28 FORMAT (4X,'SNOW-COVERED ICE,   OCEAN FLUX =',F11.6,', CONDUCTIVE
     2FLUX =',F11.6,', AND OUTGOING LONGWAVE FLUX =',F11.5,',',F11.5
     3 /2F9.4,4F15.5)
   22 CONTINUE
      IF(TS.GE.273.15) GO TO 15
C   WHEN SNOW IS NOT MELTING, UPDATE TEMPERATURE AND ADD SNOWFALL
      HS=HS+DT*SNO(M)
      IF(IHEMI.EQ.1.AND.M.EQ.8.AND.DAY.GT.20.)  HS=HS+DT*SNO(M+1)
      GO TO 14
   15 CONTINUE
C   CALCULATE SNOW MELT
      HS=HS+DT*(FA-FS)/QS
      HS=AMIN1(HS,HSL)
      IF (HS.LT.0.01) HS=0.0
      IF (FA.LE.FS) GO TO 14
      T1T3=DT*(FA-FS)/QS
      PRINT 8,NY,M,N,I,J,FA,FS,T1T3
    8 FORMAT (1X,5I3,3F20.10)
   14 CONTINUE
C2+C3 CONTINUED
C  CALCULATE BOTTOM ABLATION OR ACCRETION AND THE CHANGE IN LEAD AREA.
      HI=HI+DT*(FO-FMI)/QI
      IF (HI.GE.HL) GO TO 16
      HI=AMAX1(HI,0.0)
C ADJUST WATER TEMPERATURE FOR MELT
      TWI=(TWI*(DMIX-0.88*HL)+TB   *0.88*(HL-HI))/(DMIX-0.88*HI)
   16 CONTINUE
C CALCULATE LEAD TEMPERATURE AND CHANGE IN LEAD AREA
      FLUXIN=DT*((1.0-AW)*TSFLUX+FDMO-SIGMA*(TW**4)*EMW+FSENW+FLATW+
     1  FLONW*EMW)
      IF (FLUXIN.LT.0.0) GO TO 17
C IF FLUXIN IS POSITIVE,INCREASE THE WATER TEMPERATURE AND LEAD AREA
      TW=TW+FLUXIN*ALAST/(DMIX*CW)
      IF (HI.LT.0.001) GO TO 33
      AREA=ALAST+FLUXIN*ALAST*(1.0-ALAST)/(QI*HI+QS*HS)
   33 CONTINUE
      TTRANS=(TWI*(DMIX-0.88*HI)+TB*0.88*HI)/DMIX
      IF (AREA.GT.1.0) GO TO 19
      TW=(TW*ALAST+TTRANS*(AREA-ALAST))/AREA
      GO TO 20
   19 CONTINUE
      TW=TW*ALAST+TTRANS*(1.0-ALAST)
      TW=TW+(QI*HI+QS*HS)*(AREA-1.0)/(DMIX*CW)
      TWI=TW
      GO TO 26
C  IF FLUXIN IS NEGATIVE, DECREASE THE WATER TEMPERATURE
   17 CONTINUE
      TW=TW+FLUXIN/(DMIX*CW)
C  IF DECREASED WATER TEMPERATURE IS BELOW FREEZING, DECREASE LEAD AREA
      IF (TW.GE.TB) GO TO 20
      IF (HI.LT.0.001) GO TO 34
      AREA=ALAST-(TB-TW)*DMIX*CW*ALAST/(QI*HI)
   34 CONTINUE
      TW=TB
C IF LEAD AREA FALLS BELOW MINIMUM, COOL THE WATER
      IF (AREA.GE.AMIN) GO TO 23
      TWI=(TWI*(1.0-ALAST)+TW*(ALAST-AMIN))/(1.0-AMIN)
      TWI=TWI-(QI*HI*(AMIN-AREA))/(DMIX*CW*(1.0-AMIN ))
      AREA=AMIN
      IF (TWI.GE.TB) GO TO 20
      HI=HI+DMIX*CW*(TB-TWI)/QI
      TWI=TB
      GO TO 20
   23 CONTINUE
      TWI=(TWI*(1.0-ALAST)+TW*(ALAST-AREA))/(1.0-AREA)
   20 CONTINUE
C  ADJUST TEMPERATURES FOR LATERAL MIXING
      TWI=TWI+0.25*AREA*(TW-TWI)
      TW=TW+0.25*(1.0-AREA)*(TWI-TW)*(1.0-(0.88*HI/DMIX))
      IF (HI.LT.HMIN) GO TO 26
      GO TO 11
C  RESET VALUES WHEN ICE DISAPPEARS.
   26 CONTINUE
      HS=0.
      HI=0.
      AREA=1.0
      TS=TB
   11 CONTINUE
      IF (NCC.NE.2) GO TO 24
      TT1=SIGMA*(TW**4)*EMW
      TT2=TT2*(1.0-AREA)+TT1*AREA
      PRINT 25, AREA,TT1,TT2
   25 FORMAT (4X,'NEW LEAD AREA =',F7.4,',OUTGOING LW FROM LEADS =',
     2 F13.6,', GRID SQUARE OUTGOING LW =',F13.6)
   24 CONTINUE
      RETURN
      END
C
      SUBROUTINE SOLARF(M,N,IT,JT)
C
      COMMON /C1/ TEMP,FLON,DEW  ,VP,CLDD,DRAGW
      COMMON /C6/ RLAT,RLONG,DLAT,DLONG,NSTEP,
     1COSZ,STIME,TIME,TSFLUX,XLAT(42,31),XLON(42,31)
      DATA SOLCST/81180.0/
C  TSFLUX IS THE TOTAL SOLAR RADIATION AT THE SURFACE
C  AT LOCATION X,Y FOR THE 24 HOURS CENTERED AT
C  TIMESTEP N+5 OF MONTH M.
C  UNITS OF TSFLUX - J M-2 S-1
C  NEED X,Y,VP,CLDD,     M,N,NSTEP
C  LLL=THE TIMESTEP (IN THE YEAR) ABOUT WHICH THE CALCULATIONS ARE
C  CENTERED.
      LLL=N+5+90*(M-1)
      IF (LLL  .GE.1081) LLL  =LLL  -1080
C  OBTAIN TIME ABOUT WHICH THE 24HRS ARE CENTERED
      L1=30*LLL  /NSTEP
      RNSTEP=FLOAT(NSTEP)
      RN=FLOAT(LLL  )-RNSTEP*FLOAT(L1)/30.0
C  GTIME =GREENWICH SOLAR TIME IN HOURS.
      GTIME=RN*720.0/RNSTEP
      TIME=GTIME+DLONG/15.0
      MT=IFIX(TIME/24)
      X1=FLOAT(MT)
      TIME=TIME-X1 *24.0
C  CALCULATE TSFLUX THROUGH 2 1-HR. AND 11 2-HR. SUMMANDS
      SFLUX=0.0
      DO 110 I=1,11
      J=2*(I-6)
      STIME=TIME+FLOAT(J)
      LSTEP=LLL
      IF (STIME.GE.0.0) GO TO 50
      LSTEP=LLL-3
      STIME=STIME+24.0
      GO TO 60
   50 CONTINUE
      IF (STIME.LE.24.0) GO TO 60
      LSTEP=LLL+3
      STIME=STIME-24.0
   60 CONTINUE
C  CALLING GEOMR OBTAINS THE COSINE OF THE SOLAR ZENITH ANGLE, COSZ.
      CALL GEOMR(LSTEP,IT,JT)
      Q0=SOLCST*COSZ
C  (FISR IS THE MOMENTARY FLUX OF INCOMING
C  SOLAR RADIATION.)
      FISR=Q0*(COSZ)/(((COSZ+2.7)*VP/1.0E5    )+1.085*COSZ+0.100)
      SFLUX=SFLUX+FISR*120.0
  110 CONTINUE
      STIME=TIME-11.5
      LSTEP=LLL
      IF (STIME.GE.0.0) GO TO 120
      LSTEP=LLL-3
      STIME = STIME +24.0
  120 CONTINUE
      CALL GEOMR(LSTEP,IT,JT)
      Q0=SOLCST*COSZ
      FISR=Q0*(COSZ)/(((COSZ+2.7)*VP/1.0E5    )+1.085*COSZ+0.100)
      SFLUX=SFLUX+FISR*60.0
      STIME=TIME+11.5
      LSTEP=LLL
      IF (STIME.LE.24.0) GO TO 130
      LSTEP=LLL+3
      STIME=STIME-24.0
  130 CONTINUE
      CALL GEOMR(LSTEP,IT,JT)
      Q0=SOLCST*COSZ
      FISR=Q0*(COSZ)/(((COSZ+2.7)*VP/1.0E5    )+1.085*COSZ+0.100)
      TSFLUX=(SFLUX+FISR*60.0)*(1.0-0.6*CLDD**3)
      TSFLUX=TSFLUX/86400.0
      RETURN
      END
C
      SUBROUTINE COORD (IT,JT,IHEMI)
C
C  NORTHERN HEMISPHERE
C  X,Y COORDINATES ARE INPUTTED, LATITUDE AND LONGITUDE ARE OUTPUTTED.
C  DLAT, DLONG REFER TO DEGREES OF LATITUDE AND LONGITUDE
C  RLAT, RLONG REFER TO RADIANS OF LATITUDE AND LONGITUDE
C  NEED X,Y, AND NEED THEM SUCH THAT (0,0) SIGNIFIES THE POLE.
      COMMON /C6/ RLAT,RLONG,DLAT,DLONG,NSTEP,
     1COSZ,STIME,TIME,TSFLUX,XLAT(42,31),XLON(42,31)
      DATA B1/0.016569/
      DO 60 I=1,IT
      DO 60 J=1,JT
      IF(IHEMI.EQ.2) GO TO 5
      X= FLOAT(I)-24.0
      Y= FLOAT(J)-19.0
      GO TO 8
    5 CONTINUE
      Y= FLOAT(I)-21.0
      X= FLOAT(J)-21.0
    8 CONTINUE
      IF (X.EQ.0.0) GO TO 19
      IF (Y.LT.0.0) GO TO 10
      IF (X.LT.0.0) GO TO 11
      A=Y/X
      RLONG=ATAN(A)
      GO TO 20
   10 IF (X.LT.0.0) GO TO 12
      A=-Y/X
      RLONG=6.283185  -ATAN(A)
      GO TO 20
   12 A=Y/X
      RLONG=3.141593  +ATAN(A)
      GO TO 20
   11 A=-Y/X
      RLONG=3.141593   -ATAN(A)
   20 CONTINUE
      COSLON=COS(RLONG)
      B=X*B1/COSLON
      GO TO 50
   19 IF (Y.LT.0.0) GO TO 18
      RLONG=1.570796
      B=Y*B1
      GO TO 50
   18 RLONG=4.712389
      B=-Y*B1
   50 SINLAT=(1.0-B*B)/(1.0+B*B)
      RLAT=ARSIN(SINLAT)
      IF(IHEMI.EQ.2) RLAT=-RLAT
      XLAT(I,J)=RLAT
      XLON(I,J)=RLONG
   60 CONTINUE
      RETURN
      END
C
      SUBROUTINE GEOMR(LSTEP,IT,JT)
C
C  CALCULATING THE COSINE OF THE ZENITH ANGLE GIVEN THE TIME OF DAY
C  LSTEP OBTAINS NDAY, THE NUMBER OF THE DAY OF THE YEAR.
C  STIME=SOLAR TIME OF DAY.
C  NEED LSTEP, STIME,RLAT
      COMMON /C6/ RLAT,RLONG,DLAT,DLONG,NSTEP,
     1COSZ,STIME,TIME,TSFLUX,XLAT(42,31),XLON(42,31)
      HA=(12.0-STIME)*0.2618
C  OBTAIN DECLINATION
      NDAY=1+LSTEP*30/NSTEP
      J=172-NDAY
      ANG=FLOAT(J)*0.01745
      DDEC=23.44*COS(ANG)
      RDEC=DDEC*0.01745
C  OBTAIN DESIRED COSINE OF THE ZENITH ANGLE
      COSZ=SIN(RLAT)*SIN(RDEC)+ COS(RLAT)*COS(RDEC)*COS(HA)
      IF (COSZ .LT. 0.0) COSZ=0.0
      RETURN
      END
C
      SUBROUTINE FILONG (M,IHEMI)
C
C  OBTAINS INCOMING LONGWAVE FLUX THROUGH IDSO
C  AND JACKSONS FORMULA, 1969.
C  ALSO OBTAINS LATENT HEAT
C  TD IS DEW POINT TEMPERATURE IN DEGREES C.
C  NEED TEMP, TD, HI,TOCEAN,WIND,TS.
      COMMON /C1/ TEMP,FLONG,DEW ,VP,CLDD        ,DRAGW
      COMMON /C4/ TS,TI,HI,HS,TW,WIND,TWI,FLAT,DRAG,FLATW,FLONW
      COMMON /C9/ AIRD
      COMMON /C10/ Q10M,QSURF
      SIGMA=5.67E-8
      AA=-0.000777*((273.0-TEMP)**2)
      A0=SIGMA*(TEMP**4  )*(1.0-0.261*(2.7183**AA))
      FLONG=A0*(1.0+.275*CLDD*(2-IHEMI)-.25*CLDD*(1-IHEMI))
      FLONW=FLONG
C  CALCULATE LATENT HEAT FLUX
      TD=DEW-273.15
      X=(TD*9.5)/(TD+265.5)
      VP=611.*(10.0**X)
      Q10M=(0.622  *VP)/(101300.-VP)
      COEF=AIRD*2.834E6  *DRAG
      SVP=611.0*(2.718**(21.874*(TS -273.16)/(  TS -7.66))  )
      QSURF=(0.622*SVP)/(101300.-.378*SVP)
      FLAT=      COEF *WIND*(Q10M-QSURF)
      X=(TD*7.5)/(TD+237.5)
      VPW=611.*(10.0**X)
      Q10M=(0.622*VPW )/(101300.-VPW)
      COEF=AIRD*2.5E6    *DRAGW
      SVP=611.0*(2.718**(17.269*(TW   -273.16)/(TW -35.86)) )
      QSURF=(0.622*SVP)/(101300.-.378*SVP)
      FLATW=     COEF *WIND*(Q10M-QSURF)
      RETURN
      END
C
      SUBROUTINE DNAMIC(N,M,NY,IT,JT,IHEMI)
C
      COMMON SEALND(42,41),TSNOW(42,31),HICE(42,31),HSNO(42,31),
     1FREE(42,31),FXSOL(42,31),TOCN(42,31),FXBTM(42,31),TICE(42,31),
     2 TEMPM(42,31,12),DEWM(42,31,12),UMAT(42,31,12),VMAT(42,31,12)
      COMMON /C2/ AREA,AMIN,DT,DMIX,EYN,QS,QI,SIGMA,SK,TB,YK
      COMMON /C4/ TS,TI,HI,HS,TW,WIND,TWI,FLAT,DRAG,FLATW,FLONW
      COMMON /C5/ DTOP(42,41)
      COMMON /C6/ RLAT,RLONG,DLAT,DLONG,NSTEP,
     1COSZ,STIME,TIME,TSFLUX,XLAT(42,31),XLON(42,31)
      COMMON /C7/ NCC,NCB
      COMMON /C8/ UICE(42,31),VICE(42,31),STEP
      COMMON /C9/ AIRD
      DIMENSION REMAIN(42,31)
      DIMENSION PERICE(42,31), ALOWED(42,31), ALLOW(4),FADD(4)
      DIMENSION SPCICE(42,31)
      DIMENSION L(4),S(4),D(4),T(4)
      DIMENSION  DEPTH(42,31)
      DIMENSION ADD(4)
      NITER=0
      COVMAX=1.0-AMIN
      DT=28800.0
      M2=M
      IF (N.GE.46) M2=M+1
      M1=M2-1
      IF (M2.EQ.13) M2=1
      IF (M1.EQ.0) M1=12
      NCNT=0.0
C  CALCULATE ICE VELOCITIES
      DO 10 I=1,IT
      DO 10 J=1,JT
      UWIND=(UMAT(I,J,M2)-UMAT(I,J,M1))*STEP+UMAT(I,J,M1)
      VWIND=(VMAT(I,J,M2)-VMAT(I,J,M1))*STEP+VMAT(I,J,M1)
      IF (HICE(I,J).EQ.0.0) GO TO 26
      IF (SEALND(I,J).EQ.0.0) GO TO 26
      ANG=ATAN2(VWIND,UWIND)
C  WIND STRESS  20 DEGREES TO THE LEFT  OF THE GEOSTROPHIC WIND
      NBC=3-2*IHEMI
      ANGLE=ANG+0.349066*NBC
      IM1=I-1
      IP1=I+1
      JP1=J+1
      JM1=J-1
      IF (JP1.GT.JT) GO TO 20
      IF (JM1.LT.1) GO TO 21
      DIFF1=DTOP(I,JP1)-DTOP(I,JM1)
      GO TO 22
   20 DIFF1=2.0*(DTOP(I,J)-DTOP(I,JM1))
      GO TO 22
   21 DIFF1=2.0*(DTOP(I,JP1)-DTOP(I,J))
   22 CONTINUE
      IF (IP1.GT.IT) GO TO 23
      IF (IM1.LT.1 ) GO TO 24
      DIFF2=DTOP(IP1,J)-DTOP(IM1,J)
      GO TO 25
   23 DIFF2=2.0*(DTOP(I,J)-DTOP(IM1,J))
      GO TO 25
   24 DIFF2=2.0*(DTOP(IP1,J)-DTOP(I,J))
   25 CONTINUE
      RLAT=XLAT(I,J)
      CORF=(14.584E-5)*SIN(RLAT)
      A1=3.0*.0024*AIRD*(UWIND*UWIND+VWIND*VWIND)
      UGEOC=-DIFF1/(4.0E4*CORF)
      VGEOC= DIFF2/(4.0E4*CORF)
      A2=900.0*HICE(I,J)*CORF
C  50.2145=1025*SQRT(0.0024)
      A11=SQRT(ABS(CORF))*(50.119+0.0955*IHEMI)
      COSANG=COS(ANGLE)
      SINANG=SIN(ANGLE)
      SUMSQ=A11*A11+A2*A2
      UR=(-A1*A11*COSANG-A1*A2*SINANG)/SUMSQ
      VR=(-A1*A11*SINANG+A1*A2*COSANG)/SUMSQ
      UICE(I,J)=UGEOC-UR
      VICE(I,J)=VGEOC-VR
      IF (NCB.NE.1) GO TO 100
      IF (I.EQ.12.AND.J.EQ.13) GO TO 94
      IF (I.EQ.16.AND.J.EQ.27) GO TO 94
      GO TO 100
   94 CONTINUE
      TT1=A1*COSANG
      TT2=A1*SINANG
      TT3=A11*UR
      TT4=A11*VR
      TT5=SQRT(TT3*TT3+TT4*TT4)
      TT6=A2*VICE(I,J)
      TT7=-A2*UICE(I,J)
      TT8=SQRT(TT6*TT6+TT7*TT7)
      TT9=-900.0*HICE(I,J)*DIFF2/4.0E4
      TT10=-900.0*HICE(I,J)*DIFF1/4.0E4
      TT11=SQRT(TT9*TT9+TT10*TT10)
      PRINT 91,I,J,UICE(I,J),VICE(I,J),A1,TT1,TT2,TT5,TT3,TT4,TT8,TT6,
     1 TT7,TT11,TT9,TT10,HICE(I,J) ,HSNO(I,J),FREE(I,J)
   91 FORMAT(2X,2I3/
     1 4X, 'UICE =',F9.5,', VICE =',F9.5,', WIND STRESS =',F13.6,
     2 '(',2F13.6,')' / 4X,'WATER STRESS =',F13.6,'(',2F13.6,'), CORIOLI
     4S FORCE =',F13.6,'(',2F13.6,')' / 4X,'DYNAMIC TOPOGRAPHY =',
     5 F13.6,'(',2F13.6,')' /4X,' INITIALLY HICE =',F8.5,',HSNO =',
     6 F8.5,', AND FREE =',F8.5)
  100 CONTINUE
      GO TO 27
C  IF ON LAND OR HAVE NO ICE -
   26 UICE(I,J)=0.0
      VICE(I,J)=0.0
   27 CONTINUE
10    CONTINUE
C  NOW HAVE CALCULATED ICE VELOCITIES AT EACH GRIDPOINT
C  DO NOT ALLOW ON-LAND VELOCITIES
      DO 70 I=1,IT
      DO 70 J=1,JT
       DEPTH(I,J)=0.0
      N8=0
      N9=0
      IF (UICE(I,J)) 71,72,73
   71 N8=-2
   73 N8=N8+1
      II=I+N8
      IF (II.LT.1.OR.II.GT.IT) GO TO 72
      IF (SEALND(II,J).EQ.0.0) UICE(I,J)=0.0
   72 CONTINUE
      IF (VICE(I,J)) 74,75,76
   74 N9=-2
   76 N9=N9+1
      JJ=J+N9
      IF (JJ.LT.1.OR.JJ.GT.JT)GO TO 75
      IF (SEALND(I,JJ).EQ.0.0) VICE(I,J)=0.0
   75 CONTINUE
   70 CONTINUE
C  ZERO OUT DEVELOPING PERCENTS ICE
   84 CONTINUE
      DO 11 I=1,IT
      DO 11 J=1,JT
      PERICE(I,J)=0.0
      REMAIN(I,J)=0.0
   11 CONTINUE
C  INITIAL CALCULATION OF RE-DISTRIBUTED LEAD AREAS
      DO 30 I=1,IT
      DO 30 J=1,JT
      IF (SEALND(I,J).EQ.0.0) GO TO 30
      IF(HICE(I,J).EQ.0.0) GO TO 30
      AA1= DT*UICE(I,J)/2.0E5
      AA2= DT*VICE(I,J)/2.0E5
      AAA3       =(1.0-FREE(I,J))*(1.0-ABS(AA1))*(1.0-ABS(AA2))
      REMAIN(I,J)=AMIN1(AAA3,COVMAX)
      ENDI=FLOAT(I)+AA1
      ENDJ=FLOAT(J)+AA2
      II=ENDI
      JJ=ENDJ
      IX=II+1
      JY=JJ+1
      ADD(1)=(1.0-ENDI+II)*(1.0-ENDJ+JJ)
      ADD(2)=(ENDI-II)    *(1.0-ENDJ+JJ)
      ADD(3)=(1.0-ENDI+II)*(ENDJ-JJ)
      ADD(4)=(ENDI-II)    *(ENDJ-JJ)
      ICOUNT=0
      DO 32 JJJ=JJ,JY
      DO 32 III=II,IX
      ICOUNT=ICOUNT+1
      IF (III.LT.1.OR.III.GT.IT.OR.JJJ.LT.1.OR.JJJ.GT.JT) GO TO 32
      PERICE(III,JJJ)=(1.0-FREE(I,J))*ADD(ICOUNT) +PERICE(III,JJJ)
   32 CONTINUE
   30 CONTINUE
      NITER=NITER+1
      I8=0
      CCCMAX=COVMAX+0.001
      DO 64 I=1,IT
      DO 64 J=1,JT
      IF (PERICE(I,J).LE.CCCMAX) GO TO 64
      I8=1
   64 CONTINUE
      IF (I8.EQ.0) GO TO 820
C  RE-ADJUST ICE VELOCITIES
      CMAX=COVMAX
      DO 50 I=1,IT
      DO 50 J=1,JT
      IF (SEALND(I,J).EQ.0.0) GO TO 50
      IF (  HICE(I,J).EQ.0.0) GO TO 50
      B10=1.0
      B11=1.0
      B12=1.0
      N8=0
      N9=0
      IF (UICE(I,J)) 950,51, 951
  950 N8=-2
  951 N8=N8+1
      II=I+N8
      IF (II.LT.1.OR.II.GT.IT) GO TO 51
      IF (PERICE(II,J).LE.COVMAX) GO TO 51
      B10=(COVMAX-REMAIN(II,J))/(PERICE(II,J)-REMAIN(II,J))
      IF (REMAIN(II,J).GT.CMAX) B10=0.0
   51 CONTINUE
      IF (VICE(I,J) ) 952, 52 ,953
  952 N9=-2
  953 N9=N9+1
      JJ=J+N9
      IF (JJ.LT.1.OR.JJ.GT.JT) GO TO 52
      IF (PERICE(I,JJ).LE.COVMAX)  GO TO 52
      B11=                             (COVMAX-REMAIN(I,JJ))/
     1 (PERICE(I,JJ)-REMAIN(I,JJ))
      IF (REMAIN(I,JJ) .GT.CMAX) B11=0.0
   52 CONTINUE
      IF (II.LT.1.OR.II.GT.IT.OR.JJ.LT.1.OR.JJ.GT.JT) GO TO 955
      IF (PERICE(II,JJ).GT.COVMAX) B12=(COVMAX-REMAIN(II,JJ))/
     1 (PERICE(II,JJ)-REMAIN(II,JJ))
  955 CONTINUE
   54 UICE(I,J)=UICE(I,J)*AMIN1(B10,B12)
      VICE(I,J)=VICE(I,J)*AMIN1(B11,B12)
   50 CONTINUE
      GO TO 84
  820 CONTINUE
      DO 35 I=1,IT
      DO 35 J=1,JT
      IF (SEALND(I,J).EQ.0.0) GO TO 35
      IF (HICE(I,J).EQ.0.0) GO TO 35
      ENDI=FLOAT(I)+(DT*UICE(I,J)/2.0E5)
      ENDJ=FLOAT(J)+(DT*VICE(I,J)/2.0E5)
      II=ENDI
      JJ=ENDJ
      IX=II+1
      JY=JJ+1
      AA=HICE(I,J)*(1.0-FREE(I,J))
      ADD(1)=(1.0-ENDI+II)*(1.0-ENDJ+JJ)
      ADD(2)=(ENDI-II)    *(1.0-ENDJ+JJ)
      ADD(3)=(1.0-ENDI+II)*(ENDJ-JJ)
      ADD(4)=(ENDI-II)    *(ENDJ-JJ)
      ICOUNT=0
      DO154 JJJ=JJ,JY
      DO154 III=II,IX
      ICOUNT=ICOUNT+1
      IF (III.LT.1.OR.III.GT.IT.OR.JJJ.LT.1.OR.JJJ.GT.JT) GO TO154
      DEPTH(III,JJJ)=DEPTH(III,JJJ)+AA* ADD(ICOUNT)
  154 CONTINUE
   35 CONTINUE
      DO 55 I=1,IT
      DO 55 J=1,JT
      IF (SEALND(I,J).EQ.0.0) GO TO 55
      FREE(I,J)=1.0-PERICE(I,J)
      IF (FREE(I,J).GT.0.99.OR.DEPTH(I,J).EQ.0.) GO TO 56
      HICE(I,J)=DEPTH(I,J)/(1.0-FREE(I,J))
  104 CONTINUE
      GO TO 55
   56 FREE(I,J)=1.0
      HICE(I,J)=0.0
      HSNO(I,J)=0.0
   55 CONTINUE
      IF(IHEMI.EQ.1) GO TO 93
      IF(NCB.NE.1) GO TO 93
      I=12
      J=13
      PRINT 92,UICE(I,J),VICE(I,J),HICE(I,J),HSNO(I,J),FREE(I,J),
     1 NITER,UMAT(I,J,M),VMAT(I,J,M),TEMPM(I,J,M),DEWM(I,J,M)
   92 FORMAT (4X,'FINAL UICE =',F9.5,', VICE =',F9.5,', HICE =',F8.5,
     2 ', HSNO =',F8.5,', FREE =',F8.5,', AND THE NUMBER OF ITERATIONS W
     4AS',I3/1X,'ATMOSPHERIC INPUTS',4F10.5,'THESE LAST 2 LINES ARE FOR
     5POINT 12,13')
   93 CONTINUE
      RETURN
      END
/*
//*
//* *********************************************
//*     INPUT JCL FOR ARCTIC AND ANTARCTIC CASES
//* *********************************************
//*
//*O.FT08F001 DD DUMMY
//GO.FT08F001 DD UNIT=(3400-6,,DEFER),DISP=OLD,
//    LABEL=(1,NL,,IN),VOL=SER=100422,
//    DCB=(RECFM=FB,LRECL=5212,BLKSIZE=31272,DEN=4)
//* *********** ARCTIC CASE ABOVE
//*
//*
//* LABEL=(1,NL,,IN),VOL=SER=100767,
//* DCB=(RECFM=FB,LRECL=6728,BLKSIZE=26912,DEN=4)
//* ******** ANTARCTIC CASE ABOVE
//*
//* *********************************************
//*  OUTPUT JCL FOR ARCTIC AND ANTARCTIC CASES
//* *********************************************
//*
//GO.FT04F001 DD DUMMY
//*O.FT04F001 DD UNIT=(3400-6,,DEFER),DISP=NEW,
//*
//* ******** ARCTIC CASE
//* LABEL=(1,SL,,OUT),VOL=SER=100408,DSN=FEAST.OUTPUT,
//* DCB=(RECFM=FB,LRECL=6888,BLKSIZE=27552,DEN=4)
//*
//* ******** ANTARCTIC CASE
//* LABEL=(1,SL,,OUT),VOL=SER=100499,DSN=FEAST.OUTPUT,
//* DCB=(RECFM=FB,LRECL=6888,BLKSIZE=27552,DEN=4)
//*
//GO.SYSIN DD *
1111111111110000000000000000000000000111111111
1111111111110000000000000000000000000111111111
1111111111110000000000000000000000111111111111
111111111111000000000000000000010011111111111111111
111111111111100000000000000000011111111111111111111
111111111111100000000000000000001111111111111111111
111111111111100000000000000000001111111111111111111
111111111111100000000000000000001100011111111111111
111111111111100000000000000000111000011111111111111
111111111111000000000000000011110000111111111111111
111111111000000000110000000111100000111111111111111
111111110000000001111000000111000000111111111111111
111111100000000001111000000000000000111111111111111
111111111100000001111111100000000000100111111111111
111111111100000011111111100000000001100111111111111
111111111111110111111111111100000011111111110001111
111111111111111111111111111100001111111111000001111
111111111111001111111111111111111111111111000000000
111111111110000111111111111111111111111111110000000
111111111110000111111111111111001111111111111100000
111111111100000111111111111111001111111000011000000
111111111100000111111111111111111111000000000000000
111111111100000011111111111111111110000000000000000
111111110000000000111111111111111100000000000000000
111111100010000000111111111111111100000000000000000
111111000110000000001100011111011100000000000000000
111111001110000000000000001111111100000000000000000
111111111110000000000000000001110000000000000000000
111111111111000000000000000000000000000000000000000
1111111111110000000000000000000000000000000000
1111111111110000000000000000000000000000000000
 0.33 0.33 0.33 0.33 0.32 0.32 0.31 0.30 0.29 0.29 0.31 0.32 0.32 0.32
 0.37 0.37 0.37 0.37 0.37 0.37 0.37 0.36 0.36 0.36 0.35 0.34 0.33 0.33
 0.32 0.31 0.30 0.30 0.29 0.28 0.28 0.27 0.26 0.21 0.18 0.15 0.14 0.15
 0.33 0.33 0.32 0.32 0.32 0.32 0.31 0.30 0.29 0.29 0.31 0.32 0.32 0.32
 0.37 0.37 0.37 0.37 0.37 0.37 0.37 0.36 0.36 0.36 0.35 0.34 0.33 0.33
 0.32 0.31 0.30 0.30 0.29 0.28 0.28 0.27 0.25 0.20 0.17 0.14 0.14 0.15
 0.33 0.32 0.32 0.32 0.32 0.31 0.30 0.29 0.29 0.31 0.32 0.32 0.32 0.32
 0.37 0.37 0.37 0.37 0.37 0.37 0.37 0.36 0.36 0.36 0.35 0.34 0.33 0.33
 0.32 0.31 0.30 0.30 0.29 0.28 0.27 0.25 0.20 0.17 0.14 0.14 0.14 0.14
 0.32 0.32 0.31 0.31 0.30 0.29 0.28 0.29 0.30 0.31 0.32 0.32 0.32 0.32
 0.37 0.37 0.37 0.37 0.37 0.37 0.37 0.36 0.36 0.36 0.35 0.34 0.33 0.33
 0.30 0.30 0.30 0.29 0.28 0.27 0.25 0.20 0.17 0.14 0.14 0.13 0.12 0.13
 0.32 0.31 0.31 0.30 0.29 0.28 0.27 0.28 0.29 0.31 0.32 0.32 0.32 0.32
 0.37 0.37 0.37 0.37 0.37 0.37 0.37 0.36 0.36 0.36 0.35 0.34 0.33 0.33
 0.30 0.30 0.30 0.29 0.28 0.27 0.25 0.20 0.17 0.14 0.14 0.13 0.12 0.13
 0.31 0.31 0.31 0.30 0.28 0.27 0.27 0.28 0.29 0.30 0.31 0.32 0.32 0.32
 0.37 0.37 0.37 0.37 0.37 0.37 0.37 0.36 0.36 0.36 0.35 0.34 0.33 0.33
 0.30 0.30 0.30 0.29 0.29 0.27 0.25 0.20 0.17 0.14 0.14 0.13 0.12 0.13
 0.31 0.31 0.30 0.29 0.28 0.27 0.26 0.27 0.28 0.29 0.31 0.32 0.32 0.32
 0.37 0.37 0.37 0.37 0.37 0.37 0.37 0.36 0.36 0.36 0.34 0.33 0.30 0.30
 0.30 0.30 0.30 0.29 0.30 0.28 0.25 0.20 0.16 0.14 0.13 0.13 0.12 0.13
 0.31 0.30 0.29 0.28 0.28 0.27 0.27 0.27 0.28 0.29 0.31 0.32 0.32 0.32
 0.37 0.37 0.37 0.37 0.37 0.37 0.37 0.36 0.36 0.36 0.33 0.30 0.30 0.30
 0.30 0.30 0.29 0.30 0.30 0.30 0.25 0.20 0.15 0.14 0.13 0.12 0.13 0.14
 0.30 0.30 0.29 0.28 0.28 0.27 0.27 0.28 0.29 0.30 0.31 0.32 0.32 0.32
 0.37 0.37 0.37 0.37 0.36 0.37 0.37 0.36 0.36 0.36 0.33 0.30 0.30 0.30
 0.30 0.29 0.30 0.30 0.30 0.30 0.25 0.19 0.15 0.14 0.13 0.12 0.13 0.14
 0.30 0.29 0.28 0.28 0.28 0.28 0.29 0.29 0.30 0.31 0.32 0.32 0.32 0.32
 0.37 0.37 0.37 0.38 0.38 0.37 0.37 0.37 0.36 0.36 0.30 0.30 0.30 0.30
 0.29 0.30 0.30 0.31 0.30 0.30 0.25 0.18 0.14 0.14 0.13 0.12 0.13 0.14
 0.29 0.28 0.28 0.28 0.28 0.28 0.30 0.31 0.31 0.32 0.32 0.32 0.32 0.32
 0.37 0.37 0.38 0.40 0.39 0.38 0.38 0.37 0.37 0.36 0.30 0.30 0.30 0.30
 0.30 0.30 0.31 0.31 0.30 0.30 0.25 0.17 0.14 0.13 0.13 0.12 0.13 0.14
 0.28 0.28 0.28 0.28 0.29 0.30 0.31 0.31 0.32 0.32 0.32 0.32 0.32 0.32
 0.37 0.38 0.44 0.46 0.40 0.39 0.39 0.38 0.38 0.37 0.30 0.30 0.30 0.30
 0.30 0.30 0.31 0.31 0.30 0.30 0.25 0.15 0.13 0.13 0.12 0.13 0.14 0.15
 0.28 0.28 0.28 0.29 0.30 0.31 0.33 0.33 0.33 0.33 0.33 0.33 0.33 0.33
 0.36 0.42 0.51 0.54 0.47 0.40 0.39 0.39 0.38 0.38 0.30 0.30 0.30 0.30
 0.30 0.32 0.32 0.31 0.31 0.30 0.23 0.14 0.13 0.12 0.12 0.13 0.14 0.16
 0.28 0.28 0.29 0.30 0.31 0.32 0.33 0.33 0.33 0.33 0.33 0.33 0.33 0.36
 0.36 0.48 0.56 0.61 0.54 0.46 0.41 0.39 0.38 0.38 0.35 0.34 0.30 0.30
 0.34 0.33 0.32 0.31 0.30 0.27 0.21 0.13 0.12 0.11 0.12 0.13 0.14 0.16
 0.28 0.29 0.30 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.34
 0.36 0.55 0.62 0.62 0.58 0.51 0.45 0.42 0.41 0.40 0.39 0.38 0.37 0.35
 0.34 0.33 0.32 0.30 0.27 0.25 0.16 0.12 0.11 0.09 0.10 0.12 0.14 0.16
 0.28 0.29 0.30 0.31 0.29 0.29 0.30 0.31 0.31 0.31 0.31 0.31 0.33 0.35
 0.36 0.50 0.54 0.54 0.55 0.53 0.49 0.46 0.44 0.42 0.40 0.38 0.37 0.35
 0.33 0.32 0.30 0.27 0.20 0.14 0.11 0.08 0.06 0.07 0.09 0.11 0.15 0.16
 0.29 0.30 0.31 0.29 0.28 0.28 0.29 0.30 0.31 0.31 0.31 0.31 0.32 0.34
 0.35 0.40 0.45 0.48 0.49 0.50 0.45 0.44 0.43 0.41 0.39 0.38 0.36 0.34
 0.32 0.29 0.23 0.16 0.11 0.08 0.06 0.06 0.06 0.07 0.09 0.11 0.15 0.16
 0.30 0.31 0.30 0.29 0.28 0.28 0.28 0.29 0.31 0.31 0.29 0.30 0.30 0.33
 0.34 0.36 0.40 0.43 0.44 0.43 0.40 0.38 0.39 0.38 0.35 0.34 0.32 0.30
 0.25 0.20 0.13 0.09 0.06 0.04 0.03 0.04 0.07 0.08 0.09 0.12 0.15 0.15
 0.30 0.30 0.29 0.28 0.28 0.28 0.28 0.28 0.31 0.31 0.27 0.28 0.29 0.30
 0.32 0.33 0.35 0.36 0.38 0.37 0.34 0.34 0.33 0.32 0.30 0.27 0.24 0.21
 0.15 0.12 0.08 0.06 0.04 0.02 0.02 0.04 0.07 0.08 0.10 0.11 0.13 0.14
 0.30 0.29 0.28 0.28 0.28 0.28 0.28 0.28 0.31 0.31 0.26 0.26 0.27 0.28
 0.30 0.30 0.32 0.33 0.33 0.33 0.32 0.31 0.31 0.28 0.26 0.23 0.21 0.17
 0.12 0.09 0.07 0.06 0.0  0.0  0.03 0.06 0.08 0.10 0.11 0.12 0.13 0.14
 0.29 0.28 0.28 0.28 0.28 0.28 0.28 0.29 0.31 0.31 0.25 0.25 0.25 0.26
 0.28 0.28 0.29 0.30 0.31 0.30 0.28 0.28 0.27 0.25 0.23 0.20 0.18 0.15
 0.10 0.08 0.07 0.05 0.02 0.03 0.07 0.08 0.11 0.12 0.13 0.14 0.15 0.15
 0.29 0.28 0.28 0.28 0.28 0.29 0.29 0.30 0.31 0.31 0.25 0.25 0.25 0.25
 0.27 0.27 0.28 0.28 0.28 0.27 0.24 0.23 0.22 0.20 0.18 0.17 0.15 0.12
 0.09 0.08 0.07 0.04 0.04 0.06 0.08 0.10 0.11 0.12 0.13 0.14 0.15 0.15
 0.29 0.29 0.29 0.29 0.29 0.29 0.30 0.31 0.31 0.31 0.25 0.25 0.25 0.25
 0.25 0.26 0.26 0.26 0.26 0.25 0.23 0.20 0.19 0.17 0.16 0.14 0.13 0.11
 0.09 0.07 0.05 0.03 0.04 0.06 0.08 0.10 0.11 0.12 0.13 0.13 0.13 0.13
 0.29 0.29 0.29 0.29 0.29 0.30 0.31 0.31 0.31 0.31 0.25 0.25 0.25 0.25
 0.25 0.25 0.25 0.24 0.23 0.22 0.20 0.19 0.18 0.17 0.15 0.14 0.12 0.11
 0.08 0.06 0.04 0.04 0.06 0.07 0.08 0.09 0.10 0.10 0.10 0.10 0.10 0.11
 0.30 0.29 0.29 0.29 0.30 0.31 0.31 0.31 0.31 0.31 0.25 0.25 0.25 0.25
 0.24 0.24 0.23 0.23 0.22 0.20 0.19 0.18 0.17 0.16 0.14 0.13 0.12 0.10
 0.07 0.05 0.05 0.06 0.06 0.07 0.08 0.09 0.09 0.09 0.09 0.09 0.09 0.09
 0.30 0.30 0.30 0.30 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.25
 0.24 0.24 0.23 0.22 0.21 0.20 0.19 0.18 0.16 0.14 0.13 0.13 0.12 0.10
 0.08 0.06 0.06 0.06 0.07 0.08 0.09 0.09 0.09 0.09 0.09 0.09 0.09 0.09
 0.30 0.30 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.25
 0.23 0.23 0.23 0.22 0.21 0.20 0.18 0.17 0.15 0.14 0.13 0.12 0.11 0.09
 0.07 0.06 0.06 0.06 0.07 0.08 0.09 0.09 0.09 0.09 0.09 0.09 0.09 0.09
 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.25
 0.23 0.23 0.23 0.22 0.21 0.20 0.18 0.17 0.15 0.14 0.13 0.12 0.11 0.10
 0.08 0.07 0.07 0.07 0.08 0.08 0.09 0.09 0.09 0.09 0.09 0.09 0.09 0.09
 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.25
 0.23 0.23 0.23 0.22 0.21 0.10 0.18 0.16 0.15 0.14 0.13 0.12 0.11 0.10
 0.09 0.08 0.07 0.07 0.08 0.08 0.09 0.09 0.09 0.09 0.09 0.09 0.09 0.09
 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.25
 0.23 0.23 0.23 0.22 0.21 0.10 0.18 0.16 0.15 0.14 0.13 0.12 0.11 0.10
 0.09 0.08 0.07 0.07 0.08 0.08 0.09 0.09 0.09 0.09 0.09 0.09 0.09 0.09
 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31
 0.23 0.23 0.23 0.22 0.21 0.10 0.18 0.16 0.15 0.14 0.13 0.12 0.11 0.10
 0.09 0.08 0.07 0.07 0.08 0.08 0.09 0.09 0.09 0.09 0.09 0.09 0.09 0.09
11111111111111111111111111111111111111111                  SP41
11111111111111111111111111111111111111111                  SP40
11111111111111111111111111111111111111111                  SP39
11111111111111111111111111111111111111111                  SP38
11111111111111111111111111111111111111111                  SP37
11111111111111111111111111111111111111111                  SP36
11111111111111111111111111111111111111111                  SP35
11111111111111111111111111111111111111111                  SP34
11111111111111111111111111111111111111111                  SP33
11111111111111111111111111111111111111111                  SP32
11111111111111111111110000001111111111111                  SP31
11111111111111111111110000000011111111111                  SP30
11111111111111111111110000000011111111111                  SP29
11111111111111111111110000000001111111111                  SP28
11111111111111100011110000000001111111111                  SP27
11111111111111000000000000000000011111111                  SP26
11111111111110000000000000000000011111111                  SP25
11111111111110000000000000000000011111111                  SP24
11111111111100000000000000000000011111111                  SP23
11111111111000000000000000000000011111111                  SP22
11111111111000000000000000000000011111111                  SP21
11111111111000000000000000000000011111111                  SP20
11111111111000000000000000000000111111111                  SP19
11111111110000000000000000000001111111111                  SP18
11111111110000000000000000000001111111111                  SP17
11111111000011110000000000000001111111111                  SP16
00011111011111111000000000000001111111111                  SP15
00011111011111111000000000000001111111111                  SP14
11111111111111111000000000000111111111111                  SP13
11111111111111111100000000011111111111111                  SP12
11111111111111111100000011111111111111111                  SP11
11111111111111111111111111111111111111111                  SP10
11111111111111111111111111111111111111111                  SP 9
11111111111111111111111111111111111111111                  SP 8
11111111111111111111111111111111111111111                  SP 7
11111111111111111111111111111111111111111                  SP 6
11111111111111111111111111111111111111111                  SP 5
11111111111111111111111111111111111111111                  SP 4
11111111111111111111111111111111111111111                  SP 3
11111111111111111111111111111111111111111                  SP 2
11111111111111111111111111111111111111111                  SP 1
 2.87 2.85 2.81 2.80 2.76 2.74 2.73 2.70 2.69 2.67 2.66 2.63 2.61 2.54
 2.49 2.46 2.45 2.43 2.39 2.31 2.24 2.20 2.40 2.71 2.74 2.70 2.57 2.44
 2.40 2.46 2.51 2.56 2.76 2.83 2.87 2.82 2.82 2.84 2.86 2.85 2.84
 2.85 2.82 2.79 2.77 2.74 2.72 2.70 2.68 2.66 2.64 2.61 2.55 2.46 2.38
 2.33 2.31 2.31 2.30 2.27 2.23 2.18 2.17 2.30 2.52 2.63 2.56 2.44 2.36
 2.33 2.37 2.44 2.49 2.55 2.62 2.67 2.71 2.76 2.81 2.84 2.84 2.83
 2.81 2.80 2.77 2.75 2.73 2.70 2.68 2.65 2.63 2.59 2.51 2.38 2.25 2.19
 2.16 2.15 2.15 2.15 2.15 2.13 2.10 2.09 2.19 2.35 2.41 2.25 2.10 2.09
 2.13 2.19 2.28 2.31 2.35 2.45 2.54 2.62 2.71 2.78 2.82 2.83 2.81
 2.80 2.78 2.75 2.73 2.71 2.68 2.65 2.60 2.53 2.44 2.29 2.11 1.99 1.97
 1.98 1.98 1.98 1.99 2.00 2.00 1.99 2.00 2.07 2.15 2.09 1.91 1.81 1.84
 1.90 1.96 2.02 2.05 2.11 2.26 2.41 2.54 2.65 2.75 2.81 2.82 2.81
 2.76 2.75 2.73 2.70 2.68 2.66 2.60 2.49 2.34 2.16 1.94 1.78 1.74 1.75
 1.78 1.80 1.81 1.81 1.82 1.83 1.84 1.85 1.89 1.88 1.77 1.66 1.63 1.64
 1.66 1.68 1.74 1.80 1.88 2.03 2.22 2.39 2.53 2.68 2.79 2.84 2.81
 2.75 2.72 2.70 2.68 2.66 2.63 2.54 2.35 2.12 1.86 1.62 1.51 1.50 1.53
 1.58 1.61 1.63 1.63 1.63 1.64 1.65 1.64 1.62 1.56 1.48 1.42 1.42 1.42
 1.43 1.48 1.55 1.65 1.76 1.89 2.05 2.22 2.35 2.52 2.73 2.86 2.81
 2.73 2.70 2.67 2.65 2.63 2.59 2.43 2.18 1.92 1.65 1.44 1.34 1.31 1.33
 1.36 1.38 1.39 1.40 1.41 1.41 1.41 1.39 1.34 1.29 1.25 1.23 1.24 1.26
 1.31 1.38 1.47 1.58 1.69 1.81 1.95 2.08 2.19 2.35 2.60 2.80 2.82
 2.69 2.67 2.64 2.62 2.59 2.50 2.27 2.00 1.74 1.51 1.33 1.24 1.20 1.19
 1.19 1.18 1.18 1.19 1.19 1.20 1.20 1.19 1.17 1.15 1.14 1.14 1.17 1.21
 1.26 1.33 1.41 1.50 1.59 1.69 1.82 1.94 2.05 2.20 2.44 2.66 2.88
 2.67 2.64 2.61 2.58 2.53 2.40 2.15 1.88 1.62 1.41 1.27 1.19 1.15 1.13
 1.11 1.10 1.09 1.09 1.09 1.10 1.10 1.11 1.10 1.10 1.09 1.10 1.12 1.16
 1.21 1.26 1.33 1.40 1.48 1.56 1.66 1.78 1.89 2.03 2.22 2.40 2.51
 2.63 2.60 2.56 2.51 2.44 2.29 2.06 1.81 1.56 1.36 1.24 1.18 1.14 1.12
 1.10 1.09 1.08 1.08 1.07 1.08 1.08 1.08 1.07 1.06 1.05 1.06 1.07 1.09
 1.12 1.17 1.24 1.31 1.38 1.45 1.53 1.63 1.73 1.83 1.96 2.10 2.26
 2.61 2.57 2.51 2.43 2.32 2.17 1.97 1.75 1.53 1.36 1.26 1.21 1.18 1.14
 1.12 1.10 1.09 1.08 1.07 1.07 1.07 1.05 1.04 1.03 1.02 1.02 1.03 1.04
 1.06 1.10 1.16 1.23 1.30 1.36 1.43 1.52 1.60 1.68 1.75 1.87 2.02
 2.60 2.54 2.47 2.35 2.21 2.05 1.87 1.68 1.50 1.38 1.31 1.26 1.22 1.18
 1.15 1.12 1.10 1.09 1.08 1.07 1.06 1.04 1.02 1.01 1.01 1.01 1.01 1.01
 1.02 1.04 1.09 1.16 1.23 1.28 1.35 1.43 1.51 1.58 1.63 1.71 1.80
 2.59 2.51 2.42 2.29 2.13 1.97 1.79 1.62 1.49 1.40 1.33 1.27 1.22 1.18
 1.15 1.12 1.09 1.08 1.07 1.06 1.05 1.03 1.01 1.01 1.01 1.01 1.01 1.01
 1.01 1.02 1.05 1.11 1.16 1.22 1.28 1.36 1.44 1.51 1.56 1.62 1.73
 2.56 2.48 2.38 2.25 2.08 1.91 1.74 1.60 1.49 1.40 1.31 1.24 1.19 1.14
 1.11 1.08 1.06 1.05 1.05 1.05 1.04 1.02 1.01 1.01 1.01 1.01 1.01 1.01
 1.01 1.01 1.03 1.07 1.11 1.17 1.23 1.30 1.38 1.45 1.50 1.56 1.63
 2.54 2.46 2.35 2.22 2.05 1.88 1.72 1.59 1.49 1.39 1.30 1.21 1.14 1.10
 1.06 1.04 1.03 1.02 1.03 1.03 1.03 1.02 1.01 1.01 1.01 1.01 1.01 1.01
 1.01 1.01 1.02 1.04 1.07 1.12 1.18 1.25 1.33 1.39 1.44 1.50 1.59
 2.53 2.44 2.33 2.20 2.05 1.87 1.71 1.59 1.48 1.38 1.29 1.19 1.11 1.06
 1.03 1.01 1.01 1.01 1.02 1.02 1.02 1.01 1.01 1.01 1.01 1.01 1.01 1.01
 1.01 1.01 1.01 1.02 1.04 1.08 1.15 1.21 1.28 1.33 1.38 1.46 1.56
 2.53 2.44 2.32 2.19 2.03 1.84 1.69 1.57 1.47 1.37 1.27 1.16 1.08 1.03
 1.01 1.01 1.01 1.01 1.01 1.02 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01
 1.01 1.01 1.01 1.01 1.02 1.06 1.12 1.19 1.24 1.29 1.34 1.43 1.55
 2.53 2.45 2.33 2.16 1.98 1.81 1.67 1.56 1.46 1.36 1.25 1.13 1.05 1.02
 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01
 1.01 1.01 1.01 1.01 1.02 1.05 1.10 1.16 1.21 1.26 1.32 1.41 1.53
 2.53 2.46 2.33 2.14 1.95 1.79 1.65 1.54 1.44 1.34 1.22 1.09 1.03 1.01
 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01
 1.01 1.01 1.01 1.01 1.01 1.03 1.08 1.14 1.20 1.25 1.32 1.41 1.53
 2.53 2.46 2.34 2.14 1.94 1.77 1.64 1.53 1.42 1.31 1.18 1.06 1.01 1.01
 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01
 1.01 1.01 1.01 1.01 1.01 1.03 1.07 1.14 1.19 1.24 1.31 1.40 1.51
 2.53 2.46 2.35 2.18 1.97 1.78 1.65 1.54 1.42 1.29 1.15 1.05 1.01 1.01
 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01
 1.01 1.01 1.01 1.01 1.01 1.04 1.09 1.14 1.18 1.23 1.29 1.37 1.45
 2.50 2.45 2.36 2.23 2.04 1.84 1.69 1.56 1.42 1.27 1.13 1.05 1.01 1.01
 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01
 1.01 1.01 1.01 1.01 1.03 1.07 1.12 1.16 1.18 1.21 1.25 1.33 1.44
 2.47 2.45 2.38 2.27 2.11 1.92 1.73 1.56 1.42 1.25 1.11 1.04 1.01 1.01
 1.00 1.00 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01
 1.01 1.01 1.01 1.02 1.04 1.09 1.16 1.20 1.21 1.21 1.23 1.29 1.37
 2.50 2.51 2.44 2.32 2.16 1.95 1.72 1.54 1.38 1.21 1.08 1.03 1.01 1.00
 1.00  .99 1.00 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01
 1.01 1.01 1.01 1.02 1.06 1.11 1.18 1.24 1.26 1.25 1.26 1.29 1.35
 2.55 2.59 2.53 2.39 2.20 1.94 1.69 1.48 1.31 1.14 1.04 1.01 1.01 1.00
 1.00  .99 1.00 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01
 1.01 1.01 1.01 1.03 1.07 1.13 1.21 1.28 1.32 1.34 1.35 1.38 1.38
 2.67 2.67 2.61 2.47 2.23 1.92 1.65 1.42 1.22 1.08 1.02 1.00 1.00 1.00
 1.00 1.00 1.00 1.00 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01
 1.01 1.01 1.02 1.04 1.09 1.15 1.23 1.30 1.36 1.41 1.46 1.50 1.53
 2.76 2.71 2.65 2.52 2.24 1.89 1.61 1.37 1.15 1.04 1.00 1.00 1.00  .99
 1.00 1.00 1.00 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01
 1.01 1.01 1.02 1.06 1.12 1.18 1.24 1.31 1.37 1.45 1.53 1.59 1.64
 2.81 2.74 2.67 2.52 2.20 1.83 1.56 1.33 1.12 1.02  .99  .99 1.00  .99
 1.00 1.00 1.00 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01
 1.01 1.01 1.03 1.08 1.14 1.19 1.25 1.32 1.38 1.46 1.56 1.64 1.69
 2.80 2.73 2.65 2.48 2.15 1.79 1.52 1.31 1.12 1.01  .99  .99 1.00 1.00
  .99 1.00 1.00 1.00 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01
 1.01 1.02 1.05 1.10 1.16 1.21 1.27 1.33 1.39 1.48 1.59 1.67 1.69
 2.74 2.69 2.62 2.47 2.17 1.82 1.53 1.30 1.12 1.02 1.00 1.00 1.00 1.00
  .99  .99 1.00 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.01 1.02 1.02 1.03
 1.04 1.05 1.09 1.14 1.19 1.24 1.30 1.35 1.41 1.51 1.62 1.69 1.70
 2.64 2.62 2.57 2.48 2.25 1.92 1.60 1.33 1.13 1.04 1.01 1.00 1.00 1.00
  .99  .99  .99 1.01 1.02 1.02 1.01 1.01 1.01 1.02 1.03 1.05 1.06 1.06
 1.07 1.10 1.13 1.18 1.22 1.27 1.32 1.37 1.45 1.55 1.66 1.73 1.77
 2.58 2.55 2.51 2.44 2.26 1.97 1.67 1.39 1.17 1.06 1.02 1.00 1.00  .99
  .99  .98  .98 1.00 1.02 1.02 1.02 1.02 1.03 1.04 1.06 1.08 1.09 1.10
 1.12 1.14 1.17 1.21 1.25 1.30 1.35 1.41 1.50 1.60 1.69 1.77 1.83
 2.52 2.47 2.41 2.33 2.18 1.96 1.71 1.46 1.25 1.12 1.04 1.01 1.00 1.00
  .99  .97  .96  .97 1.00 1.01 1.02 1.02 1.04 1.06 1.08 1.10 1.12 1.14
 1.16 1.18 1.21 1.24 1.29 1.33 1.38 1.46 1.55 1.65 1.73 1.80 1.87
 2.43 2.35 2.27 2.16 2.03 1.87 1.69 1.50 1.33 1.19 1.09 1.04 1.02 1.01
 1.01  .98  .95  .94  .96  .98 1.00 1.01 1.03 1.06 1.08 1.11 1.14 1.17
 1.20 1.22 1.24 1.28 1.32 1.37 1.43 1.51 1.61 1.70 1.77 1.83 1.89
 2.24 2.28 2.20 2.07 1.91 1.74 1.61 1.50 1.38 1.26 1.15 1.08 1.05 1.05
 1.04 1.00  .96  .93  .92  .94  .96  .98 1.00 1.03 1.06 1.10 1.14 1.18
 1.22 1.25 1.29 1.32 1.37 1.42 1.49 1.59 1.69 1.77 1.81 1.86 1.90
 2.33 2.32 2.24 2.10 1.90 1.69 1.53 1.46 1.40 1.32 1.22 1.14 1.10 1.10
 1.11 1.07 1.00  .95  .92  .92  .93  .95  .97  .99 1.02 1.06 1.12 1.17
 1.22 1.28 1.33 1.38 1.43 1.49 1.58 1.69 1.79 1.85 1.87 1.89 1.93
 2.47 2.37 2.28 2.16 1.99 1.75 1.53 1.42 1.38 1.33 1.26 1.18 1.15 1.18
 1.22 1.20 1.11 1.03  .99  .98  .96  .95  .95  .96  .98 1.01 1.07 1.13
 1.20 1.28 1.35 1.42 1.49 1.57 1.68 1.79 1.89 1.93 1.94 1.94 1.96
 2.52 2.37 2.29 2.21 2.09 1.90 1.65 1.48 1.39 1.33 1.27 1.22 1.22 1.25
 1.29 1.30 1.25 1.17 1.11 1.08 1.04 1.01  .99  .98  .98 1.00 1.04 1.10
 1.18 1.26 1.36 1.46 1.56 1.67 1.78 1.88 1.96 2.01 2.00 1.99 1.99
 2.43 2.39 2.32 2.26 2.19 2.05 1.85 1.65 1.51 1.41 1.34 1.32 1.32 1.34
 1.36 1.37 1.36 1.30 1.23 1.17 1.12 1.09 1.08 1.06 1.04 1.04 1.07 1.12
 1.20 1.29 1.41 1.55 1.69 1.81 1.92 1.99 2.05 2.08 2.08 2.11 2.15
 2.58 2.44 2.36 2.31 2.25 2.17 2.04 1.89 1.74 1.62 1.52 1.46 1.44 1.44
 1.44 1.45 1.44 1.39 1.32 1.25 1.21 1.20 1.18 1.17 1.15 1.15 1.17 1.23
 1.31 1.42 1.55 1.72 1.89 2.01 2.09 2.13 2.16 2.18 2.22 2.30 2.39
 2.64 2.49 2.39 2.36 2.32 2.26 2.18 2.09 2.02 1.92 1.77 1.63 1.57 1.56
 1.54 1.53 1.52 1.47 1.39 1.32 1.30 1.30 1.30 1.29 1.29 1.30 1.34 1.41
 1.53 1.62 1.71 2.00 2.16 2.20 2.24 2.26 2.29 2.33 2.41 2.54 2.71
/*
 
