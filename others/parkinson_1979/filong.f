      SUBROUTINE FILONG (M,IHEMI)
C
C  OBTAINS INCOMING LONGWAVE FLUX THROUGH IDSO
C  AND JACKSONS FORMULA, 1969.
C  ALSO OBTAINS LATENT HEAT
C  TD IS DEW POINT TEMPERATURE IN DEGREES C.
C  NEED TEMP, TD, HI,TOCEAN,WIND,TS.
      IMPLICIT none

      INTEGER M, IHEMI

      REAL TEMP, FLONG, DEW, VP, CLDD, DRAGW
      REAL TS, TI, HI, HS, TW, WIND, TWI, FLAT, DRAG
      REAL FLATW, FLONW, AIRD, Q10M, QSURF
     
      REAL SIGMA, AA, A0, TD, X, COEF, SVP, VPW 
 
      COMMON /C1/ TEMP,FLONG,DEW ,VP, CLDD, DRAGW
      COMMON /C4/ TS,TI,HI,HS,TW,WIND,TWI,FLAT,DRAG,FLATW,FLONW
      COMMON /C9/ AIRD
      COMMON /C10/ Q10M,QSURF

      SIGMA=5.67E-8
      AA=-0.000777*((273.0-TEMP)**2)
      A0=SIGMA*(TEMP**4  )*(1.0-0.261*(2.7183**AA))
      FLONG=A0*(1.0+.275*CLDD*(2-IHEMI)-.25*CLDD*(1-IHEMI))
      FLONW=FLONG
C  CALCULATE LATENT HEAT FLUX
      TD=DEW-273.15

      X=(TD*9.5)/(TD+265.5)
      VP=611.*(10.0**X)
      Q10M=(0.622  *VP)/(101300.-VP)
      COEF=AIRD*2.834E6  *DRAG
      SVP=611.0*(2.718**(21.874*(TS -273.16)/(  TS -7.66))  )
      QSURF=(0.622*SVP)/(101300.-.378*SVP)
      FLAT=      COEF *WIND*(Q10M-QSURF)

      X=(TD*7.5)/(TD+237.5)
      VPW=611.*(10.0**X)
      Q10M=(0.622*VPW )/(101300.-VPW)
      COEF=AIRD*2.5E6    *DRAGW
      SVP=611.0*(2.718**(17.269*(TW -273.16)/(TW -35.86)) )
      QSURF=(0.622*SVP)/(101300.-.378*SVP)
      FLATW=     COEF *WIND*(Q10M-QSURF)

      RETURN
      END
