C
      SUBROUTINE SFT991(A,WORK,TRIGS,IFAX,INC,JUMP,N,LOT,ISIGN,
     $                  W1,W2,W3,W4,W5,W6)
C     Mark Iredell 7 April 1994
C
C
C*    IMPLICIT REAL*8(A-H,O-Z)
      DIMENSION A(N),WORK(N),TRIGS(N),IFAX(10)
      DIMENSION W1(LOT),W2(LOT),W3(LOT),W4(LOT),W5(LOT),W6(LOT)
C
      NFAX=IFAX(1)
      NX=N+1
      NH=N/2
      INK=INC+INC
      IF(ISIGN.EQ.1) GO TO 30
C
      IGO=50
      IF(MOD(NFAX,2).EQ.1) GO TO 40
      IBASE=1
      JBASE=1
      DO 20 L=1,LOT
      I=IBASE
      J=JBASE
      DO 10 M=1,N
      WORK(J)=A(I)
      I=I+INC
      J=J+1
   10 CONTINUE
      IBASE=IBASE+JUMP
      JBASE=JBASE+NX
   20 CONTINUE
C
      IGO=60
      GO TO 40
C
   30 CONTINUE
      CALL SFT99A(A,WORK,TRIGS,INC,JUMP,N,LOT,W1,W2,W3,W4,W5,W6)
      IGO=60
C
   40 CONTINUE
      IA=1
      LA=1
      DO 80 K=1,NFAX
      IF(IGO.EQ.60) GO TO 60
   50 CONTINUE
      CALL SPASSM(A(IA),A(IA+INC),WORK(1),WORK(2),TRIGS,INK,2,JUMP,NX,
     $   LOT,NH,IFAX(K+1),LA,W1,W2,W3,W4,W5,W6)
      IGO=60
      GO TO 70
   60 CONTINUE
      CALL SPASSM(WORK(1),WORK(2),A(IA),A(IA+INC),TRIGS,2,INK,NX,JUMP,
     $   LOT,NH,IFAX(K+1),LA,W1,W2,W3,W4,W5,W6)
      IGO=50
   70 CONTINUE
      LA=LA*IFAX(K+1)
   80 CONTINUE
C
      IF(ISIGN.EQ.-1) GO TO 130
C
      IF(MOD(NFAX,2).EQ.1) GO TO 110
      IBASE=1
      JBASE=1
      DO 100 L=1,LOT
      I=IBASE
      J=JBASE
      DO 90 M=1,N
      A(J)=WORK(I)
      I=I+1
      J=J+INC
   90 CONTINUE
      IBASE=IBASE+NX
      JBASE=JBASE+JUMP
  100 CONTINUE
C
  110 CONTINUE
      RETURN
C
  130 CONTINUE
      CALL SFT99B(WORK,A,TRIGS,INC,JUMP,N,LOT,W1,W2,W3,W4,W5,W6)
C
  140 CONTINUE
      RETURN
C
      END
