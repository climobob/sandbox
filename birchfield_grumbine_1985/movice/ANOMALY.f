      SUBROUTINE ANOMALY(LAT, TOFYR, TIME, ANOM)
  
      COMMON/TEMP/INSOL 
  
      REAL INSOL, LAT, TIME, PRESVAL, ANOM
      INTEGER TOFYR 
      INTEGER FIRST, LAST, STEP 
  
      ANOM = 0.0
      DO 100 TOFYR = FIRST, LAST, STEP
  
C     SUBTRACT THE PRESENT VALUE OF INSOLATION FROM COMPUTED VALUE
C       TO GET ANOMALY. 
C     THE FIRST ARGUMENT IS THE LATITUDE TO COMPUTE FOR 
C     THE SECOND IS THE TIME OF YEAR. 1=VERNAL EQUINOX
C         31=THE AUTUMNAL EQUINOX 
      CALL ASTR(0.0)
      CALL YEAR(LAT, TOFYR) 
      PRESVAL = INSOL 
  
C     NOW COMPUTE THE INSOLATION FOR THE DESIRED ASTRONOMICAL TIME
      CALL ASTR (TIME)
      CALL YEAR(LAT, TOFYR) 
      ANOM = INSOL - PRESVAL  + ANOM
  
  100 CONTINUE
  
      ANOM = ANOM/(((LAST-FIRST)/STEP)+1) 
      RETURN
  
      ENTRY ANOMSET (LAT, TOFYR, TIME, ANOM)
  
      FIRST = 16
      LAST  = 16
      STEP  =  1
      CALL ASTSET 
  
      RETURN
      END 
