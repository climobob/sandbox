      SUBROUTINE CONVEC(SS, SD, TS, TD, CD, NX, NY, SREF, TREF, TSTEP)
C     SUBROUTINE TO LOOK FOR CONVECTIVE OVERTURNING AND CABBELING.
C     OVERTURN ADDED 3-9-88.
C     USES SHORT FORM ENTRY POINT TO RHO 5-26-88.

      INTEGER NX, NY, TSTEP
      REAL SS(NX, NY), SD(NX, NY), TS(NX, NY), TD(NX, NY), CD(NX, NY)
      REAL SREF, TREF

      INTEGER I, J, TLAST
      REAL RHOS1P, RHO1, RHO2
      LOGICAL OVRTRN, OVRLST
      SAVE    OVRLST

      OVRTRN = .FALSE.
      DO 1000 J = 1, NY
        DO 1010 I = 1, NX
          RHO1 = RHOS1P(SS(I,J)+SD(I,J), TS(I,J)+TD(I,J), 0.)
          RHO2 = RHOS1P(SS(I,J)-SD(I,J), TS(I,J)-TD(I,J), 0.)
          IF (RHO1 .GT. RHO2) THEN
            SD(I,J) = 0.0
            TD(I,J) = 0.0
            CD(I,J) = 0.0
CD          PRINT *,'CONVECTIVE OVERTURN AT I,J',I,J,' TS=',TSTEP
            OVRTRN = .TRUE.
          ENDIF
 1010   CONTINUE
 1000 CONTINUE

CD    IF (OVRTRN) PRINT *,'CONVECTIVE OVERTURNING AT TS= ',TSTEP
      IF (TSTEP .EQ. 1) GO TO 9999

      IF (OVRTRN .AND. (.NOT. OVRLST) ) THEN
        PRINT *,'STARTED CONVECTION AT TSTEP',TSTEP
       ELSE IF ((.NOT. OVRTRN)  .AND. OVRLST ) THEN
        PRINT *,'STOPPED CONVECTION AT TSTEP',TSTEP
      ENDIF

 9999 CONTINUE
      OVRLST = OVRTRN

      RETURN
      END
