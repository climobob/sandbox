      SUBROUTINE QCEXT(QCS, QCD, CS, CD, QSS, H, NX, NY, TSTEP, LOY,
     1  XMIN, XMAX, YMIN, YMAX, LAMBDA, C0, QFMAX, QFREF, QM,
     2  STRSPR, STRSUM, STRFLL, STRWIN, DCADT, DELT   )
C     HIGH FORCING SPECIFICATION CHANGED TO A RECTANGLE 12-19-88, BG.
C     FORCING FOR CHEMICALS, TAKEN FROM QSEXT.F OF 1-24-89.

      INTEGER NX, NY, TSTEP
      REAL QCS(NX, NY), QCD(NX, NY), QSS(NX, NY)
      REAL CS(NX, NY), CD(NX, NY), H(NX, NY)
      INTEGER I, J, T

      INTEGER XMIN, XMAX, YMIN, YMAX
      REAL QFMAX, QFREF, QM, LAMBDA, C0
      REAL DCADT, DELT
      INTEGER STRSPR, STRSUM, STRFLL, STRWIN, LOY
C     START OF SPRING, SUMMER, FALL, WINTER, AND LENGTH OF THE YEAR

      REAL PI, TIME
      PARAMETER (PI = 3.141592654)

      T = MOD(TSTEP,LOY)
      IF ((T .GE. STRWIN) .AND. (T .LT. STRSPR)) THEN
C     WINTERTIME
CD      PRINT *,'WINTER'
        DO 1000 J = 1, NY
          DO 1010 I = 1, NX
            QCS(I,J) = LAMBDA*(C0*EXP(DCADT*DELT*FLOAT(TSTEP))
     1                         -CS(I,J)-CD(I,J) )/H(I,J)
            QCS(I,J) = QCS(I,J)*QSS(I,J)/(QFMAX+QFREF)
            QCD(I,J) = QCS(I,J)
 1010     CONTINUE
 1000   CONTINUE
       ELSE
        DO 1100 J = 1, NY
          DO 1110 I = 1, NX
            QCS(I,J) = LAMBDA*(C0*EXP(DCADT*DELT*FLOAT(TSTEP))
     1                         -CS(I,J)-CD(I,J) )/H(I,J)
            QCD(I,J) = QCS(I,J)
 1110     CONTINUE
 1100   CONTINUE
      ENDIF

      RETURN
      END
