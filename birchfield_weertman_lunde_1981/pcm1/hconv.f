      SUBROUTINE HCONV(KRAT, HI, HPI, LHLI, IFHL, IFHELV, NIX, HTOPO) 
C     CA.7/24/80
C     CONVERT FROM ICE MODEL TO SHORT TS H FIELDS AND CONVENTIONS 
C     HI IS ELEVATION OF ICE SURFACE ABOVE MSL ON ICE MODEL SCALE 
C     HPI IS ELEVATION OF BARE ROCK BELOW MSL ON ICE MODEL SCALE
C     HL IS LAND ICE/SNOW THICKNESS ON SHORT TS(POINTER JHL)
C     HELV IS ELEVATION OF SURFACE ABOVE MSL TO USE IN SHORT TS 
C     PS-TSL COMPUTATIONS(POINTER JHELV)
C     HTOPO IS THE ELEVATION OF UNDISTURBED TOPO SHORT TS FIELD10/15/81 
C     HMI IS NEG OF HTOPO BUT FOR ISHEET GRID IS LONG TS FIELD 10/15/81 
      REAL HI(LHLI), HPI(LHLI)
C     INCORPORATE ZONAL TOPOGRAPHY 10/10/81 
      REAL HTOPO(46)
      LOGICAL IFHL, IFHELV
  
      COMMON/CONST/M, MM, MP, MPP, DUMA(43) 
      COMMON/AV3COM/JAVE, JAVEON, MZERO, MPREF, LHLS, LHOS, LXIOS 
      COMMON W(46, 50)
      COMMON/LARGE/DUMB(20), JHL, DUMC(4) 
      COMMON/MINOR/DUMD(23), JHELV, DUMME(3)
  
C     IF GRID SPACING NOT SAME AS MPREF WONT WORK 
      NIX = 0 
  
      IF(MP.EQ.MPREF) THEN
  
C       IF IFHL = .TRUE. FILL IN HL SUBFIELD
        IF(IFHL) THEN 
C         SUM HI AND HPI TO GET ICE THICKNESS 
C         PACK FROM ICE MODEL INTO SHORT TS SUBFIELD
C         REVERSING INDEXES 
            MZ = MZERO+LHLS 
            DO 20 L = 1, LHLI, KRAT 
              MZ = MZ-1 
              W(MZ, JHL) = HI(L)+HPI(L) 
 20       CONTINUE
        ENDIF 
  
C       IF IFHELV = .TRUE. FILL IN HELV FIELD 
        IF(IFHELV) THEN 
C         FILL IN NON-ISHEET MODEL LAT OF HELV WITH HTOPO 10/15/81
            DO 40 MZ = 1, MPP 
C         ADD VARIABLE ZONAL TOPOGRAPHY FIELD HTOPO 10/10/81
 40       W(MZ, JHELV) = +HTOPO(MZ) 
C         FILL IN ICE MODEL LATITUEDS WITH HI 
C         PACKED WITH REVERSED INDEXS 
            MZ = MZERO+LHLS 
            DO 50 L = 1, LHLI, KRAT 
            MZ = MZ-1 
 50       W(MZ, JHELV) = HI(L)
        ENDIF 
  
       ELSE 
        NIX = 1 
      ENDIF 
      RETURN
      END 
